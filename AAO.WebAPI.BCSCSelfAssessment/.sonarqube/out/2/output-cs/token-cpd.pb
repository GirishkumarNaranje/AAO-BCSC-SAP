Ÿ
tD:\AAO-Azure\Branches\Main\AAO.WebAPI.BCSCSelfAssessment\AAO.SQLHelper.BCSCSelfAssessment\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str ;
); <
]< =
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str =
)= >
]> ?
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *ó
rD:\AAO-Azure\Branches\Main\AAO.WebAPI.BCSCSelfAssessment\AAO.SQLHelper.BCSCSelfAssessment\SQLConnectionProvider.cs
	namespace 	
AAO
 
. 
	SQLHelper 
. 
BCSCSelfAssessment *
{ 
public 

enum 
DataAccessType 
{ 
Read 
, 
Write 
, 
}		 
public 

class !
SqlConnectionProvider &
{ 
public 
static 
string 
GetConnectionString 0
(0 1
DataAccessType1 ?
enumDataAccessType@ R
)R S
{ 	
string 
connectionString #
=$ %
string& ,
., -
Empty- 2
;2 3
switch 
( 
enumDataAccessType &
)& '
{ 
case 
DataAccessType #
.# $
Read$ (
:( )
connectionString $
=% & 
ConfigurationManager' ;
.; <
ConnectionStrings< M
[M N
$strN _
]_ `
.` a
ConnectionStringa q
;q r
break 
; 
case 
DataAccessType #
.# $
Write$ )
:) *
connectionString $
=% & 
ConfigurationManager' ;
.; <
ConnectionStrings< M
[M N
$strN _
]_ `
.` a
ConnectionStringa q
;q r
break 
; 
} 
return 
connectionString #
;# $
} 	
} 
} Òü

fD:\AAO-Azure\Branches\Main\AAO.WebAPI.BCSCSelfAssessment\AAO.SQLHelper.BCSCSelfAssessment\SqlHelper.cs
	namespace 	
AAO
 
. 
	SQLHelper 
. 
BCSCSelfAssessment *
.* +
DataAccessProvider+ =
{ 
public%% 

sealed%% 
class%% 
	SqlHelper%% !
{&& 
private++ 
	SqlHelper++ 
(++ 
)++ 
{++ 
}++ 
private99 
static99 
void99 
AttachParameters99 ,
(99, -

SqlCommand99- 7
command998 ?
,99? @
SqlParameter99A M
[99M N
]99N O
commandParameters99P a
)99a b
{:: 	
if;; 
(;; 
command;; 
==;; 
null;; 
);;  
throw;;! &
new;;' *!
ArgumentNullException;;+ @
(;;@ A
$str;;A J
);;J K
;;;K L
if<< 
(<< 
commandParameters<< !
!=<<" $
null<<% )
)<<) *
{== 
foreach>> 
(>> 
SqlParameter>> %
p>>& '
in>>( *
commandParameters>>+ <
)>>< =
{?? 
if@@ 
(@@ 
p@@ 
!=@@ 
null@@ !
)@@! "
{AA 
ifCC 
(CC 
(CC 
pCC 
.CC 
	DirectionCC (
==CC) +
ParameterDirectionCC, >
.CC> ?
InputOutputCC? J
||CCK M
pDD 
.DD 
	DirectionDD $
==DD% '
ParameterDirectionDD( :
.DD: ;
InputDD; @
)DD@ A
&&DDB D
(EE 
pEE 
.EE 
ValueEE !
==EE" $
nullEE% )
)EE) *
)EE* +
{FF 
pGG 
.GG 
ValueGG #
=GG$ %
DBNullGG& ,
.GG, -
ValueGG- 2
;GG2 3
}HH 
commandII 
.II  

ParametersII  *
.II* +
AddII+ .
(II. /
pII/ 0
)II0 1
;II1 2
}JJ 
}KK 
}LL 
}MM 	
privateTT 
staticTT 
voidTT !
AssignParameterValuesTT 1
(TT1 2
SqlParameterTT2 >
[TT> ?
]TT? @
commandParametersTTA R
,TTR S
DataRowTTT [
dataRowTT\ c
)TTc d
{UU 	
ifVV 
(VV 
(VV 
commandParametersVV "
==VV# %
nullVV& *
)VV* +
||VV, .
(VV/ 0
dataRowVV0 7
==VV8 :
nullVV; ?
)VV? @
)VV@ A
{WW 
returnYY 
;YY 
}ZZ 
int\\ 
i\\ 
=\\ 
$num\\ 
;\\ 
foreach^^ 
(^^ 
SqlParameter^^ !
commandParameter^^" 2
in^^3 5
commandParameters^^6 G
)^^G H
{__ 
ifaa 
(aa 
commandParameteraa $
.aa$ %
ParameterNameaa% 2
==aa3 5
nullaa6 :
||aa; =
commandParameterbb !
.bb! "
ParameterNamebb" /
.bb/ 0
Lengthbb0 6
<=bb7 9
$numbb: ;
)bb; <
throwcc 
newcc 
	Exceptioncc '
(cc' (
stringdd 
.dd 
Formatdd "
(dd" #
$str	ee 
,
ee 
iff 
,ff 
commandParameterff )
.ff) *
ParameterNameff* 7
)ff7 8
)ff8 9
;ff9 :
ifgg 
(gg 
dataRowgg 
.gg 
Tablegg !
.gg! "
Columnsgg" )
.gg) *
IndexOfgg* 1
(gg1 2
commandParametergg2 B
.ggB C
ParameterNameggC P
.ggP Q
	SubstringggQ Z
(ggZ [
$numgg[ \
)gg\ ]
)gg] ^
!=gg_ a
-ggb c
$numggc d
)ggd e
commandParameterhh $
.hh$ %
Valuehh% *
=hh+ ,
dataRowhh- 4
[hh4 5
commandParameterhh5 E
.hhE F
ParameterNamehhF S
.hhS T
	SubstringhhT ]
(hh] ^
$numhh^ _
)hh_ `
]hh` a
;hha b
iii 
++ii 
;ii 
}jj 
}kk 	
privaterr 
staticrr 
voidrr !
AssignParameterValuesrr 1
(rr1 2
SqlParameterrr2 >
[rr> ?
]rr? @
commandParametersrrA R
,rrR S
objectrrT Z
[rrZ [
]rr[ \
parameterValuesrr] l
)rrl m
{ss 	
iftt 
(tt 
(tt 
commandParameterstt "
==tt# %
nulltt& *
)tt* +
||tt, .
(tt/ 0
parameterValuestt0 ?
==tt@ B
nullttC G
)ttG H
)ttH I
{uu 
returnww 
;ww 
}xx 
if{{ 
({{ 
commandParameters{{ !
.{{! "
Length{{" (
!={{) +
parameterValues{{, ;
.{{; <
Length{{< B
){{B C
{|| 
throw}} 
new}} 
ArgumentException}} +
(}}+ ,
$str}}, c
)}}c d
;}}d e
}~~ 
for
‚‚ 
(
‚‚ 
int
‚‚ 
i
‚‚ 
=
‚‚ 
$num
‚‚ 
,
‚‚ 
j
‚‚ 
=
‚‚ 
commandParameters
‚‚  1
.
‚‚1 2
Length
‚‚2 8
;
‚‚8 9
i
‚‚: ;
<
‚‚< =
j
‚‚> ?
;
‚‚? @
i
‚‚A B
++
‚‚B D
)
‚‚D E
{
ƒƒ 
if
…… 
(
…… 
parameterValues
…… #
[
……# $
i
……$ %
]
……% &
is
……' )
IDbDataParameter
……* :
)
……: ;
{
†† 
IDbDataParameter
‡‡ $
paramInstance
‡‡% 2
=
‡‡3 4
(
‡‡5 6
IDbDataParameter
‡‡6 F
)
‡‡F G
parameterValues
‡‡G V
[
‡‡V W
i
‡‡W X
]
‡‡X Y
;
‡‡Y Z
if
ˆˆ 
(
ˆˆ 
paramInstance
ˆˆ %
.
ˆˆ% &
Value
ˆˆ& +
==
ˆˆ, .
null
ˆˆ/ 3
)
ˆˆ3 4
{
‰‰ 
commandParameters
ŠŠ )
[
ŠŠ) *
i
ŠŠ* +
]
ŠŠ+ ,
.
ŠŠ, -
Value
ŠŠ- 2
=
ŠŠ3 4
DBNull
ŠŠ5 ;
.
ŠŠ; <
Value
ŠŠ< A
;
ŠŠA B
}
‹‹ 
else
ŒŒ 
{
 
commandParameters
 )
[
) *
i
* +
]
+ ,
.
, -
Value
- 2
=
3 4
paramInstance
5 B
.
B C
Value
C H
;
H I
}
 
}
 
else
‘‘ 
if
‘‘ 
(
‘‘ 
parameterValues
‘‘ (
[
‘‘( )
i
‘‘) *
]
‘‘* +
==
‘‘, .
null
‘‘/ 3
)
‘‘3 4
{
’’ 
commandParameters
““ %
[
““% &
i
““& '
]
““' (
.
““( )
Value
““) .
=
““/ 0
DBNull
““1 7
.
““7 8
Value
““8 =
;
““= >
}
”” 
else
•• 
{
–– 
commandParameters
—— %
[
——% &
i
——& '
]
——' (
.
——( )
Value
——) .
=
——/ 0
parameterValues
——1 @
[
——@ A
i
——A B
]
——B C
;
——C D
}
˜˜ 
}
™™ 
}
šš 	
private
§§ 
static
§§ 
void
§§ 
PrepareCommand
§§ *
(
§§* +

SqlCommand
§§+ 5
command
§§6 =
,
§§= >
SqlConnection
§§? L

connection
§§M W
,
§§W X
SqlTransaction
§§Y g
transaction
§§h s
,
§§s t
CommandType§§u €
commandType§§ Œ
,§§Œ 
string§§ ”
commandText§§•  
,§§  ¡
SqlParameter§§¢ ®
[§§® ¯
]§§¯ °!
commandParameters§§± Â
,§§Â Ã
out§§Ä Ç
bool§§È Ì#
mustCloseConnection§§Í à
)§§à á
{
¨¨ 	
if
©© 
(
©© 
command
©© 
==
©© 
null
©© 
)
©©  
throw
©©! &
new
©©' *#
ArgumentNullException
©©+ @
(
©©@ A
$str
©©A J
)
©©J K
;
©©K L
if
ªª 
(
ªª 
commandText
ªª 
==
ªª 
null
ªª #
||
ªª$ &
commandText
ªª' 2
.
ªª2 3
Length
ªª3 9
==
ªª: <
$num
ªª= >
)
ªª> ?
throw
ªª@ E
new
ªªF I#
ArgumentNullException
ªªJ _
(
ªª_ `
$str
ªª` m
)
ªªm n
;
ªªn o
command
«« 
.
«« 
CommandTimeout
«« "
=
««# $
$num
««% (
;
««( )
if
­­ 
(
­­ 

connection
­­ 
.
­­ 
State
­­  
!=
­­! #
ConnectionState
­­$ 3
.
­­3 4
Open
­­4 8
)
­­8 9
{
®® !
mustCloseConnection
¯¯ #
=
¯¯$ %
true
¯¯& *
;
¯¯* +

connection
°° 
.
°° 
Open
°° 
(
°°  
)
°°  !
;
°°! "
}
±± 
else
²² 
{
³³ !
mustCloseConnection
´´ #
=
´´$ %
false
´´& +
;
´´+ ,
}
µµ 
command
¸¸ 
.
¸¸ 

Connection
¸¸ 
=
¸¸  

connection
¸¸! +
;
¸¸+ ,
command
»» 
.
»» 
CommandText
»» 
=
»»  !
commandText
»»" -
;
»»- .
if
¾¾ 
(
¾¾ 
transaction
¾¾ 
!=
¾¾ 
null
¾¾ #
)
¾¾# $
{
¿¿ 
if
ÀÀ 
(
ÀÀ 
transaction
ÀÀ 
.
ÀÀ  

Connection
ÀÀ  *
==
ÀÀ+ -
null
ÀÀ. 2
)
ÀÀ2 3
throw
ÀÀ4 9
new
ÀÀ: =
ArgumentException
ÀÀ> O
(
ÀÀO P
$strÀÀP ¡
,ÀÀ¡ ¢
$strÀÀ£ °
)ÀÀ° ±
;ÀÀ± ²
command
ÁÁ 
.
ÁÁ 
Transaction
ÁÁ #
=
ÁÁ$ %
transaction
ÁÁ& 1
;
ÁÁ1 2
}
ÂÂ 
command
ÅÅ 
.
ÅÅ 
CommandType
ÅÅ 
=
ÅÅ  !
commandType
ÅÅ" -
;
ÅÅ- .
if
ÈÈ 
(
ÈÈ 
commandParameters
ÈÈ !
!=
ÈÈ" $
null
ÈÈ% )
)
ÈÈ) *
{
ÉÉ 
AttachParameters
ÊÊ  
(
ÊÊ  !
command
ÊÊ! (
,
ÊÊ( )
commandParameters
ÊÊ* ;
)
ÊÊ; <
;
ÊÊ< =
}
ËË 
return
ÌÌ 
;
ÌÌ 
}
ÍÍ 	
private
ÛÛ 
static
ÛÛ 
void
ÛÛ 
PrepareCommand
ÛÛ *
(
ÛÛ* +

SqlCommand
ÛÛ+ 5
command
ÛÛ6 =
,
ÛÛ= >
SqlConnection
ÛÛ? L

connection
ÛÛM W
,
ÛÛW X
SqlTransaction
ÛÛY g
transaction
ÛÛh s
,
ÛÛs t
CommandTypeÛÛu €
commandTypeÛÛ Œ
,ÛÛŒ 
stringÛÛ ”
commandTextÛÛ•  
,ÛÛ  ¡
SqlParameterÛÛ¢ ®
[ÛÛ® ¯
]ÛÛ¯ °!
commandParametersÛÛ± Â
,ÛÛÂ Ã
intÛÛÄ Ç

cmdTimeoutÛÛÈ Ò
,ÛÛÒ Ó
outÛÛÔ ×
boolÛÛØ Ü#
mustCloseConnectionÛÛİ ğ
)ÛÛğ ñ
{
ÜÜ 	
if
İİ 
(
İİ 
command
İİ 
==
İİ 
null
İİ 
)
İİ  
throw
İİ! &
new
İİ' *#
ArgumentNullException
İİ+ @
(
İİ@ A
$str
İİA J
)
İİJ K
;
İİK L
if
ŞŞ 
(
ŞŞ 
commandText
ŞŞ 
==
ŞŞ 
null
ŞŞ #
||
ŞŞ$ &
commandText
ŞŞ' 2
.
ŞŞ2 3
Length
ŞŞ3 9
==
ŞŞ: <
$num
ŞŞ= >
)
ŞŞ> ?
throw
ŞŞ@ E
new
ŞŞF I#
ArgumentNullException
ŞŞJ _
(
ŞŞ_ `
$str
ŞŞ` m
)
ŞŞm n
;
ŞŞn o
command
ßß 
.
ßß 
CommandTimeout
ßß "
=
ßß# $

cmdTimeout
ßß% /
;
ßß/ 0
if
áá 
(
áá 

connection
áá 
.
áá 
State
áá  
!=
áá! #
ConnectionState
áá$ 3
.
áá3 4
Open
áá4 8
)
áá8 9
{
ââ !
mustCloseConnection
ãã #
=
ãã$ %
true
ãã& *
;
ãã* +

connection
ää 
.
ää 
Open
ää 
(
ää  
)
ää  !
;
ää! "
}
åå 
else
ææ 
{
çç !
mustCloseConnection
èè #
=
èè$ %
false
èè& +
;
èè+ ,
}
éé 
command
ìì 
.
ìì 

Connection
ìì 
=
ìì  

connection
ìì! +
;
ìì+ ,
command
ïï 
.
ïï 
CommandText
ïï 
=
ïï  !
commandText
ïï" -
;
ïï- .
if
òò 
(
òò 
transaction
òò 
!=
òò 
null
òò #
)
òò# $
{
óó 
if
ôô 
(
ôô 
transaction
ôô 
.
ôô  

Connection
ôô  *
==
ôô+ -
null
ôô. 2
)
ôô2 3
throw
ôô4 9
new
ôô: =
ArgumentException
ôô> O
(
ôôO P
$strôôP ¡
,ôô¡ ¢
$strôô£ °
)ôô° ±
;ôô± ²
command
õõ 
.
õõ 
Transaction
õõ #
=
õõ$ %
transaction
õõ& 1
;
õõ1 2
}
öö 
command
ùù 
.
ùù 
CommandType
ùù 
=
ùù  !
commandType
ùù" -
;
ùù- .
if
üü 
(
üü 
commandParameters
üü !
!=
üü" $
null
üü% )
)
üü) *
{
ıı 
AttachParameters
şş  
(
şş  !
command
şş! (
,
şş( )
commandParameters
şş* ;
)
şş; <
;
şş< =
}
ÿÿ 
return
€€ 
;
€€ 
}
 	
public
““ 
static
““ 
int
““ 
ExecuteNonQuery
““ )
(
““) *
string
““* 0
connectionString
““1 A
,
““A B
CommandType
““C N
commandType
““O Z
,
““Z [
string
““\ b
commandText
““c n
)
““n o
{
”” 	
return
–– 
ExecuteNonQuery
–– "
(
––" #
connectionString
––# 3
,
––3 4
commandType
––5 @
,
––@ A
commandText
––B M
,
––M N
(
––O P
SqlParameter
––P \
[
––\ ]
]
––] ^
)
––^ _
null
––_ c
)
––c d
;
––d e
}
—— 	
public
¦¦ 
static
¦¦ 
int
¦¦ 
ExecuteNonQuery
¦¦ )
(
¦¦) *
string
¦¦* 0
connectionString
¦¦1 A
,
¦¦A B
CommandType
¦¦C N
commandType
¦¦O Z
,
¦¦Z [
string
¦¦\ b
commandText
¦¦c n
,
¦¦n o
params
¦¦p v
SqlParameter¦¦w ƒ
[¦¦ƒ „
]¦¦„ …!
commandParameters¦¦† —
)¦¦— ˜
{
§§ 	
if
¨¨ 
(
¨¨ 
connectionString
¨¨  
==
¨¨! #
null
¨¨$ (
||
¨¨) +
connectionString
¨¨, <
.
¨¨< =
Length
¨¨= C
==
¨¨D F
$num
¨¨G H
)
¨¨H I
throw
¨¨J O
new
¨¨P S#
ArgumentNullException
¨¨T i
(
¨¨i j
$str
¨¨j |
)
¨¨| }
;
¨¨} ~
using
«« 
(
«« 
SqlConnection
««  

connection
««! +
=
««, -
new
««. 1
SqlConnection
««2 ?
(
««? @
connectionString
««@ P
)
««P Q
)
««Q R
{
¬¬ 

connection
­­ 
.
­­ 
Open
­­ 
(
­­  
)
­­  !
;
­­! "
return
°° 
ExecuteNonQuery
°° &
(
°°& '

connection
°°' 1
,
°°1 2
commandType
°°3 >
,
°°> ?
commandText
°°@ K
,
°°K L
commandParameters
°°M ^
)
°°^ _
;
°°_ `
}
±± 
}
²² 	
public
ÃÃ 
static
ÃÃ 
int
ÃÃ 
ExecuteNonQuery
ÃÃ )
(
ÃÃ) *
string
ÃÃ* 0
connectionString
ÃÃ1 A
,
ÃÃA B
string
ÃÃC I
spName
ÃÃJ P
,
ÃÃP Q
params
ÃÃR X
object
ÃÃY _
[
ÃÃ_ `
]
ÃÃ` a
parameterValues
ÃÃb q
)
ÃÃq r
{
ÄÄ 	
if
ÅÅ 
(
ÅÅ 
connectionString
ÅÅ  
==
ÅÅ! #
null
ÅÅ$ (
||
ÅÅ) +
connectionString
ÅÅ, <
.
ÅÅ< =
Length
ÅÅ= C
==
ÅÅD F
$num
ÅÅG H
)
ÅÅH I
throw
ÅÅJ O
new
ÅÅP S#
ArgumentNullException
ÅÅT i
(
ÅÅi j
$str
ÅÅj |
)
ÅÅ| }
;
ÅÅ} ~
if
ÆÆ 
(
ÆÆ 
spName
ÆÆ 
==
ÆÆ 
null
ÆÆ 
||
ÆÆ !
spName
ÆÆ" (
.
ÆÆ( )
Length
ÆÆ) /
==
ÆÆ0 2
$num
ÆÆ3 4
)
ÆÆ4 5
throw
ÆÆ6 ;
new
ÆÆ< ?#
ArgumentNullException
ÆÆ@ U
(
ÆÆU V
$str
ÆÆV ^
)
ÆÆ^ _
;
ÆÆ_ `
if
ÉÉ 
(
ÉÉ 
(
ÉÉ 
parameterValues
ÉÉ  
!=
ÉÉ! #
null
ÉÉ$ (
)
ÉÉ( )
&&
ÉÉ* ,
(
ÉÉ- .
parameterValues
ÉÉ. =
.
ÉÉ= >
Length
ÉÉ> D
>
ÉÉE F
$num
ÉÉG H
)
ÉÉH I
)
ÉÉI J
{
ÊÊ 
SqlParameter
ÌÌ 
[
ÌÌ 
]
ÌÌ 
commandParameters
ÌÌ 0
=
ÌÌ1 2%
SqlHelperParameterCache
ÌÌ3 J
.
ÌÌJ K
GetSpParameterSet
ÌÌK \
(
ÌÌ\ ]
connectionString
ÌÌ] m
,
ÌÌm n
spName
ÌÌo u
)
ÌÌu v
;
ÌÌv w#
AssignParameterValues
ÏÏ %
(
ÏÏ% &
commandParameters
ÏÏ& 7
,
ÏÏ7 8
parameterValues
ÏÏ9 H
)
ÏÏH I
;
ÏÏI J
return
ÒÒ 
ExecuteNonQuery
ÒÒ &
(
ÒÒ& '
connectionString
ÒÒ' 7
,
ÒÒ7 8
CommandType
ÒÒ9 D
.
ÒÒD E
StoredProcedure
ÒÒE T
,
ÒÒT U
spName
ÒÒV \
,
ÒÒ\ ]
commandParameters
ÒÒ^ o
)
ÒÒo p
;
ÒÒp q
}
ÓÓ 
else
ÔÔ 
{
ÕÕ 
return
×× 
ExecuteNonQuery
×× &
(
××& '
connectionString
××' 7
,
××7 8
CommandType
××9 D
.
××D E
StoredProcedure
××E T
,
××T U
spName
××V \
)
××\ ]
;
××] ^
}
ØØ 
}
ÙÙ 	
public
ææ 
static
ææ 
int
ææ 
ExecuteNonQuery
ææ )
(
ææ) *
SqlConnection
ææ* 7

connection
ææ8 B
,
ææB C
CommandType
ææD O
commandType
ææP [
,
ææ[ \
string
ææ] c
commandText
ææd o
)
ææo p
{
çç 	
return
éé 
ExecuteNonQuery
éé "
(
éé" #

connection
éé# -
,
éé- .
commandType
éé/ :
,
éé: ;
commandText
éé< G
,
ééG H
(
ééI J
SqlParameter
ééJ V
[
ééV W
]
ééW X
)
ééX Y
null
ééY ]
)
éé] ^
;
éé^ _
}
êê 	
public
ùù 
static
ùù 
int
ùù 
ExecuteNonQuery
ùù )
(
ùù) *
SqlConnection
ùù* 7

connection
ùù8 B
,
ùùB C
CommandType
ùùD O
commandType
ùùP [
,
ùù[ \
string
ùù] c
commandText
ùùd o
,
ùùo p
params
ùùq w
SqlParameterùùx „
[ùù„ …
]ùù… †!
commandParametersùù‡ ˜
)ùù˜ ™
{
úú 	
if
ûû 
(
ûû 

connection
ûû 
==
ûû 
null
ûû "
)
ûû" #
throw
ûû$ )
new
ûû* -#
ArgumentNullException
ûû. C
(
ûûC D
$str
ûûD P
)
ûûP Q
;
ûûQ R

SqlCommand
şş 
cmd
şş 
=
şş 
new
şş  

SqlCommand
şş! +
(
şş+ ,
)
şş, -
;
şş- .
bool
ÿÿ !
mustCloseConnection
ÿÿ $
=
ÿÿ% &
false
ÿÿ' ,
;
ÿÿ, -
PrepareCommand
€€ 
(
€€ 
cmd
€€ 
,
€€ 

connection
€€  *
,
€€* +
(
€€, -
SqlTransaction
€€- ;
)
€€; <
null
€€< @
,
€€@ A
commandType
€€B M
,
€€M N
commandText
€€O Z
,
€€Z [
commandParameters
€€\ m
,
€€m n
out
€€o r"
mustCloseConnection€€s †
)€€† ‡
;€€‡ ˆ
int
ƒƒ 
retval
ƒƒ 
=
ƒƒ 
cmd
ƒƒ 
.
ƒƒ 
ExecuteNonQuery
ƒƒ ,
(
ƒƒ, -
)
ƒƒ- .
;
ƒƒ. /
cmd
†† 
.
†† 

Parameters
†† 
.
†† 
Clear
††  
(
††  !
)
††! "
;
††" #
if
‡‡ 
(
‡‡ !
mustCloseConnection
‡‡ #
)
‡‡# $

connection
ˆˆ 
.
ˆˆ 
Close
ˆˆ  
(
ˆˆ  !
)
ˆˆ! "
;
ˆˆ" #
return
‰‰ 
retval
‰‰ 
;
‰‰ 
}
ŠŠ 	
public
›› 
static
›› 
int
›› 
ExecuteNonQuery
›› )
(
››) *
SqlConnection
››* 7

connection
››8 B
,
››B C
string
››D J
spName
››K Q
,
››Q R
params
››S Y
object
››Z `
[
››` a
]
››a b
parameterValues
››c r
)
››r s
{
œœ 	
if
 
(
 

connection
 
==
 
null
 "
)
" #
throw
$ )
new
* -#
ArgumentNullException
. C
(
C D
$str
D P
)
P Q
;
Q R
if
 
(
 
spName
 
==
 
null
 
||
 !
spName
" (
.
( )
Length
) /
==
0 2
$num
3 4
)
4 5
throw
6 ;
new
< ?#
ArgumentNullException
@ U
(
U V
$str
V ^
)
^ _
;
_ `
if
¡¡ 
(
¡¡ 
(
¡¡ 
parameterValues
¡¡  
!=
¡¡! #
null
¡¡$ (
)
¡¡( )
&&
¡¡* ,
(
¡¡- .
parameterValues
¡¡. =
.
¡¡= >
Length
¡¡> D
>
¡¡E F
$num
¡¡G H
)
¡¡H I
)
¡¡I J
{
¢¢ 
SqlParameter
¤¤ 
[
¤¤ 
]
¤¤ 
commandParameters
¤¤ 0
=
¤¤1 2%
SqlHelperParameterCache
¤¤3 J
.
¤¤J K
GetSpParameterSet
¤¤K \
(
¤¤\ ]

connection
¤¤] g
,
¤¤g h
spName
¤¤i o
)
¤¤o p
;
¤¤p q#
AssignParameterValues
§§ %
(
§§% &
commandParameters
§§& 7
,
§§7 8
parameterValues
§§9 H
)
§§H I
;
§§I J
return
ªª 
ExecuteNonQuery
ªª &
(
ªª& '

connection
ªª' 1
,
ªª1 2
CommandType
ªª3 >
.
ªª> ?
StoredProcedure
ªª? N
,
ªªN O
spName
ªªP V
,
ªªV W
commandParameters
ªªX i
)
ªªi j
;
ªªj k
}
«« 
else
¬¬ 
{
­­ 
return
¯¯ 
ExecuteNonQuery
¯¯ &
(
¯¯& '

connection
¯¯' 1
,
¯¯1 2
CommandType
¯¯3 >
.
¯¯> ?
StoredProcedure
¯¯? N
,
¯¯N O
spName
¯¯P V
)
¯¯V W
;
¯¯W X
}
°° 
}
±± 	
public
¾¾ 
static
¾¾ 
int
¾¾ 
ExecuteNonQuery
¾¾ )
(
¾¾) *
SqlTransaction
¾¾* 8
transaction
¾¾9 D
,
¾¾D E
CommandType
¾¾F Q
commandType
¾¾R ]
,
¾¾] ^
string
¾¾_ e
commandText
¾¾f q
)
¾¾q r
{
¿¿ 	
return
ÁÁ 
ExecuteNonQuery
ÁÁ "
(
ÁÁ" #
transaction
ÁÁ# .
,
ÁÁ. /
commandType
ÁÁ0 ;
,
ÁÁ; <
commandText
ÁÁ= H
,
ÁÁH I
(
ÁÁJ K
SqlParameter
ÁÁK W
[
ÁÁW X
]
ÁÁX Y
)
ÁÁY Z
null
ÁÁZ ^
)
ÁÁ^ _
;
ÁÁ_ `
}
ÂÂ 	
public
ÑÑ 
static
ÑÑ 
int
ÑÑ 
ExecuteNonQuery
ÑÑ )
(
ÑÑ) *
SqlTransaction
ÑÑ* 8
transaction
ÑÑ9 D
,
ÑÑD E
CommandType
ÑÑF Q
commandType
ÑÑR ]
,
ÑÑ] ^
string
ÑÑ_ e
commandText
ÑÑf q
,
ÑÑq r
params
ÑÑs y
SqlParameterÑÑz †
[ÑÑ† ‡
]ÑÑ‡ ˆ!
commandParametersÑÑ‰ š
)ÑÑš ›
{
ÒÒ 	
if
ÓÓ 
(
ÓÓ 
transaction
ÓÓ 
==
ÓÓ 
null
ÓÓ #
)
ÓÓ# $
throw
ÓÓ% *
new
ÓÓ+ .#
ArgumentNullException
ÓÓ/ D
(
ÓÓD E
$str
ÓÓE R
)
ÓÓR S
;
ÓÓS T
if
ÔÔ 
(
ÔÔ 
transaction
ÔÔ 
!=
ÔÔ 
null
ÔÔ #
&&
ÔÔ$ &
transaction
ÔÔ' 2
.
ÔÔ2 3

Connection
ÔÔ3 =
==
ÔÔ> @
null
ÔÔA E
)
ÔÔE F
throw
ÔÔG L
new
ÔÔM P
ArgumentException
ÔÔQ b
(
ÔÔb c
$strÔÔc ´
,ÔÔ´ µ
$strÔÔ¶ Ã
)ÔÔÃ Ä
;ÔÔÄ Å

SqlCommand
×× 
cmd
×× 
=
×× 
new
××  

SqlCommand
××! +
(
××+ ,
)
××, -
;
××- .
bool
ØØ !
mustCloseConnection
ØØ $
=
ØØ% &
false
ØØ' ,
;
ØØ, -
PrepareCommand
ÙÙ 
(
ÙÙ 
cmd
ÙÙ 
,
ÙÙ 
transaction
ÙÙ  +
.
ÙÙ+ ,

Connection
ÙÙ, 6
,
ÙÙ6 7
transaction
ÙÙ8 C
,
ÙÙC D
commandType
ÙÙE P
,
ÙÙP Q
commandText
ÙÙR ]
,
ÙÙ] ^
commandParameters
ÙÙ_ p
,
ÙÙp q
out
ÙÙr u"
mustCloseConnectionÙÙv ‰
)ÙÙ‰ Š
;ÙÙŠ ‹
int
ÜÜ 
retval
ÜÜ 
=
ÜÜ 
cmd
ÜÜ 
.
ÜÜ 
ExecuteNonQuery
ÜÜ ,
(
ÜÜ, -
)
ÜÜ- .
;
ÜÜ. /
cmd
ßß 
.
ßß 

Parameters
ßß 
.
ßß 
Clear
ßß  
(
ßß  !
)
ßß! "
;
ßß" #
return
àà 
retval
àà 
;
àà 
}
áá 	
public
òò 
static
òò 
int
òò 
ExecuteNonQuery
òò )
(
òò) *
SqlTransaction
òò* 8
transaction
òò9 D
,
òòD E
string
òòF L
spName
òòM S
,
òòS T
params
òòU [
object
òò\ b
[
òòb c
]
òòc d
parameterValues
òòe t
)
òòt u
{
óó 	
if
ôô 
(
ôô 
transaction
ôô 
==
ôô 
null
ôô #
)
ôô# $
throw
ôô% *
new
ôô+ .#
ArgumentNullException
ôô/ D
(
ôôD E
$str
ôôE R
)
ôôR S
;
ôôS T
if
õõ 
(
õõ 
transaction
õõ 
!=
õõ 
null
õõ #
&&
õõ$ &
transaction
õõ' 2
.
õõ2 3

Connection
õõ3 =
==
õõ> @
null
õõA E
)
õõE F
throw
õõG L
new
õõM P
ArgumentException
õõQ b
(
õõb c
$strõõc ´
,õõ´ µ
$strõõ¶ Ã
)õõÃ Ä
;õõÄ Å
if
öö 
(
öö 
spName
öö 
==
öö 
null
öö 
||
öö !
spName
öö" (
.
öö( )
Length
öö) /
==
öö0 2
$num
öö3 4
)
öö4 5
throw
öö6 ;
new
öö< ?#
ArgumentNullException
öö@ U
(
ööU V
$str
ööV ^
)
öö^ _
;
öö_ `
if
ùù 
(
ùù 
(
ùù 
parameterValues
ùù  
!=
ùù! #
null
ùù$ (
)
ùù( )
&&
ùù* ,
(
ùù- .
parameterValues
ùù. =
.
ùù= >
Length
ùù> D
>
ùùE F
$num
ùùG H
)
ùùH I
)
ùùI J
{
úú 
SqlParameter
üü 
[
üü 
]
üü 
commandParameters
üü 0
=
üü1 2%
SqlHelperParameterCache
üü3 J
.
üüJ K
GetSpParameterSet
üüK \
(
üü\ ]
transaction
üü] h
.
üüh i

Connection
üüi s
,
üüs t
spName
üüu {
)
üü{ |
;
üü| }#
AssignParameterValues
ÿÿ %
(
ÿÿ% &
commandParameters
ÿÿ& 7
,
ÿÿ7 8
parameterValues
ÿÿ9 H
)
ÿÿH I
;
ÿÿI J
return
‚‚ 
ExecuteNonQuery
‚‚ &
(
‚‚& '
transaction
‚‚' 2
,
‚‚2 3
CommandType
‚‚4 ?
.
‚‚? @
StoredProcedure
‚‚@ O
,
‚‚O P
spName
‚‚Q W
,
‚‚W X
commandParameters
‚‚Y j
)
‚‚j k
;
‚‚k l
}
ƒƒ 
else
„„ 
{
…… 
return
‡‡ 
ExecuteNonQuery
‡‡ &
(
‡‡& '
transaction
‡‡' 2
,
‡‡2 3
CommandType
‡‡4 ?
.
‡‡? @
StoredProcedure
‡‡@ O
,
‡‡O P
spName
‡‡Q W
)
‡‡W X
;
‡‡X Y
}
ˆˆ 
}
‰‰ 	
public
›› 
static
›› 
DataSet
›› 
ExecuteDataset
›› ,
(
››, -
string
››- 3
connectionString
››4 D
,
››D E
CommandType
››F Q
commandType
››R ]
,
››] ^
string
››_ e
commandText
››f q
)
››q r
{
œœ 	
return
 
ExecuteDataset
 !
(
! "
connectionString
" 2
,
2 3
commandType
4 ?
,
? @
commandText
A L
,
L M
(
N O
SqlParameter
O [
[
[ \
]
\ ]
)
] ^
null
^ b
)
b c
;
c d
}
ŸŸ 	
public
®® 
static
®® 
DataSet
®® 
ExecuteDataset
®® ,
(
®®, -
string
®®- 3
connectionString
®®4 D
,
®®D E
CommandType
®®F Q
commandType
®®R ]
,
®®] ^
string
®®_ e
commandText
®®f q
,
®®q r
params
®®s y
SqlParameter®®z †
[®®† ‡
]®®‡ ˆ!
commandParameters®®‰ š
)®®š ›
{
¯¯ 	
if
°° 
(
°° 
connectionString
°°  
==
°°! #
null
°°$ (
||
°°) +
connectionString
°°, <
.
°°< =
Length
°°= C
==
°°D F
$num
°°G H
)
°°H I
throw
°°J O
new
°°P S#
ArgumentNullException
°°T i
(
°°i j
$str
°°j |
)
°°| }
;
°°} ~
using
³³ 
(
³³ 
SqlConnection
³³  

connection
³³! +
=
³³, -
new
³³. 1
SqlConnection
³³2 ?
(
³³? @
connectionString
³³@ P
)
³³P Q
)
³³Q R
{
´´ 

connection
µµ 
.
µµ 
Open
µµ 
(
µµ  
)
µµ  !
;
µµ! "
return
¸¸ 
ExecuteDataset
¸¸ %
(
¸¸% &

connection
¸¸& 0
,
¸¸0 1
commandType
¸¸2 =
,
¸¸= >
commandText
¸¸? J
,
¸¸J K
commandParameters
¸¸L ]
)
¸¸] ^
;
¸¸^ _
}
¹¹ 
}
ºº 	
public
ËË 
static
ËË 
DataSet
ËË 
ExecuteDataset
ËË ,
(
ËË, -
string
ËË- 3
connectionString
ËË4 D
,
ËËD E
string
ËËF L
spName
ËËM S
,
ËËS T
params
ËËU [
object
ËË\ b
[
ËËb c
]
ËËc d
parameterValues
ËËe t
)
ËËt u
{
ÌÌ 	
if
ÍÍ 
(
ÍÍ 
connectionString
ÍÍ  
==
ÍÍ! #
null
ÍÍ$ (
||
ÍÍ) +
connectionString
ÍÍ, <
.
ÍÍ< =
Length
ÍÍ= C
==
ÍÍD F
$num
ÍÍG H
)
ÍÍH I
throw
ÍÍJ O
new
ÍÍP S#
ArgumentNullException
ÍÍT i
(
ÍÍi j
$str
ÍÍj |
)
ÍÍ| }
;
ÍÍ} ~
if
ÎÎ 
(
ÎÎ 
spName
ÎÎ 
==
ÎÎ 
null
ÎÎ 
||
ÎÎ !
spName
ÎÎ" (
.
ÎÎ( )
Length
ÎÎ) /
==
ÎÎ0 2
$num
ÎÎ3 4
)
ÎÎ4 5
throw
ÎÎ6 ;
new
ÎÎ< ?#
ArgumentNullException
ÎÎ@ U
(
ÎÎU V
$str
ÎÎV ^
)
ÎÎ^ _
;
ÎÎ_ `
if
ÑÑ 
(
ÑÑ 
(
ÑÑ 
parameterValues
ÑÑ  
!=
ÑÑ! #
null
ÑÑ$ (
)
ÑÑ( )
&&
ÑÑ* ,
(
ÑÑ- .
parameterValues
ÑÑ. =
.
ÑÑ= >
Length
ÑÑ> D
>
ÑÑE F
$num
ÑÑG H
)
ÑÑH I
)
ÑÑI J
{
ÒÒ 
SqlParameter
ÔÔ 
[
ÔÔ 
]
ÔÔ 
commandParameters
ÔÔ 0
=
ÔÔ1 2%
SqlHelperParameterCache
ÔÔ3 J
.
ÔÔJ K
GetSpParameterSet
ÔÔK \
(
ÔÔ\ ]
connectionString
ÔÔ] m
,
ÔÔm n
spName
ÔÔo u
)
ÔÔu v
;
ÔÔv w#
AssignParameterValues
×× %
(
××% &
commandParameters
××& 7
,
××7 8
parameterValues
××9 H
)
××H I
;
××I J
return
ÚÚ 
ExecuteDataset
ÚÚ %
(
ÚÚ% &
connectionString
ÚÚ& 6
,
ÚÚ6 7
CommandType
ÚÚ8 C
.
ÚÚC D
StoredProcedure
ÚÚD S
,
ÚÚS T
spName
ÚÚU [
,
ÚÚ[ \
commandParameters
ÚÚ] n
)
ÚÚn o
;
ÚÚo p
}
ÛÛ 
else
ÜÜ 
{
İİ 
return
ßß 
ExecuteDataset
ßß %
(
ßß% &
connectionString
ßß& 6
,
ßß6 7
CommandType
ßß8 C
.
ßßC D
StoredProcedure
ßßD S
,
ßßS T
spName
ßßU [
)
ßß[ \
;
ßß\ ]
}
àà 
}
áá 	
public
îî 
static
îî 
DataSet
îî 
ExecuteDataset
îî ,
(
îî, -
SqlConnection
îî- :

connection
îî; E
,
îîE F
CommandType
îîG R
commandType
îîS ^
,
îî^ _
string
îî` f
commandText
îîg r
)
îîr s
{
ïï 	
return
ññ 
ExecuteDataset
ññ !
(
ññ! "

connection
ññ" ,
,
ññ, -
commandType
ññ. 9
,
ññ9 :
commandText
ññ; F
,
ññF G
(
ññH I
SqlParameter
ññI U
[
ññU V
]
ññV W
)
ññW X
null
ññX \
)
ññ\ ]
;
ññ] ^
}
òò 	
public
 
static
 
DataSet
 
ExecuteDataset
 ,
(
, -
SqlConnection
- :

connection
; E
,
E F
CommandType
G R
commandType
S ^
,
^ _
string
` f
commandText
g r
,
r s
params
t z
SqlParameter{ ‡
[‡ ˆ
]ˆ ‰!
commandParametersŠ ›
)› œ
{
‚‚ 	
if
ƒƒ 
(
ƒƒ 

connection
ƒƒ 
==
ƒƒ 
null
ƒƒ "
)
ƒƒ" #
throw
ƒƒ$ )
new
ƒƒ* -#
ArgumentNullException
ƒƒ. C
(
ƒƒC D
$str
ƒƒD P
)
ƒƒP Q
;
ƒƒQ R

SqlCommand
†† 
cmd
†† 
=
†† 
new
††  

SqlCommand
††! +
(
††+ ,
)
††, -
;
††- .
bool
‡‡ !
mustCloseConnection
‡‡ $
=
‡‡% &
false
‡‡' ,
;
‡‡, -
PrepareCommand
ˆˆ 
(
ˆˆ 
cmd
ˆˆ 
,
ˆˆ 

connection
ˆˆ  *
,
ˆˆ* +
(
ˆˆ, -
SqlTransaction
ˆˆ- ;
)
ˆˆ; <
null
ˆˆ< @
,
ˆˆ@ A
commandType
ˆˆB M
,
ˆˆM N
commandText
ˆˆO Z
,
ˆˆZ [
commandParameters
ˆˆ\ m
,
ˆˆm n
out
ˆˆo r"
mustCloseConnectionˆˆs †
)ˆˆ† ‡
;ˆˆ‡ ˆ
using
‹‹ 
(
‹‹ 
SqlDataAdapter
‹‹ !
da
‹‹" $
=
‹‹% &
new
‹‹' *
SqlDataAdapter
‹‹+ 9
(
‹‹9 :
cmd
‹‹: =
)
‹‹= >
)
‹‹> ?
{
ŒŒ 
DataSet
 
ds
 
=
 
new
  
DataSet
! (
(
( )
)
) *
;
* +
da
 
.
 
Fill
 
(
 
ds
 
)
 
;
 
cmd
““ 
.
““ 

Parameters
““ 
.
““ 
Clear
““ $
(
““$ %
)
““% &
;
““& '
if
•• 
(
•• !
mustCloseConnection
•• '
)
••' (

connection
–– 
.
–– 
Close
–– $
(
––$ %
)
––% &
;
––& '
return
™™ 
ds
™™ 
;
™™ 
}
šš 
}
›› 	
public
¬¬ 
static
¬¬ 
DataSet
¬¬ 
ExecuteDataset
¬¬ ,
(
¬¬, -
SqlConnection
¬¬- :

connection
¬¬; E
,
¬¬E F
string
¬¬G M
spName
¬¬N T
,
¬¬T U
params
¬¬V \
object
¬¬] c
[
¬¬c d
]
¬¬d e
parameterValues
¬¬f u
)
¬¬u v
{
­­ 	
if
®® 
(
®® 

connection
®® 
==
®® 
null
®® "
)
®®" #
throw
®®$ )
new
®®* -#
ArgumentNullException
®®. C
(
®®C D
$str
®®D P
)
®®P Q
;
®®Q R
if
¯¯ 
(
¯¯ 
spName
¯¯ 
==
¯¯ 
null
¯¯ 
||
¯¯ !
spName
¯¯" (
.
¯¯( )
Length
¯¯) /
==
¯¯0 2
$num
¯¯3 4
)
¯¯4 5
throw
¯¯6 ;
new
¯¯< ?#
ArgumentNullException
¯¯@ U
(
¯¯U V
$str
¯¯V ^
)
¯¯^ _
;
¯¯_ `
if
²² 
(
²² 
(
²² 
parameterValues
²²  
!=
²²! #
null
²²$ (
)
²²( )
&&
²²* ,
(
²²- .
parameterValues
²². =
.
²²= >
Length
²²> D
>
²²E F
$num
²²G H
)
²²H I
)
²²I J
{
³³ 
SqlParameter
µµ 
[
µµ 
]
µµ 
commandParameters
µµ 0
=
µµ1 2%
SqlHelperParameterCache
µµ3 J
.
µµJ K
GetSpParameterSet
µµK \
(
µµ\ ]

connection
µµ] g
,
µµg h
spName
µµi o
)
µµo p
;
µµp q#
AssignParameterValues
¸¸ %
(
¸¸% &
commandParameters
¸¸& 7
,
¸¸7 8
parameterValues
¸¸9 H
)
¸¸H I
;
¸¸I J
return
»» 
ExecuteDataset
»» %
(
»»% &

connection
»»& 0
,
»»0 1
CommandType
»»2 =
.
»»= >
StoredProcedure
»»> M
,
»»M N
spName
»»O U
,
»»U V
commandParameters
»»W h
)
»»h i
;
»»i j
}
¼¼ 
else
½½ 
{
¾¾ 
return
ÀÀ 
ExecuteDataset
ÀÀ %
(
ÀÀ% &

connection
ÀÀ& 0
,
ÀÀ0 1
CommandType
ÀÀ2 =
.
ÀÀ= >
StoredProcedure
ÀÀ> M
,
ÀÀM N
spName
ÀÀO U
)
ÀÀU V
;
ÀÀV W
}
ÁÁ 
}
ÂÂ 	
public
ÏÏ 
static
ÏÏ 
DataSet
ÏÏ 
ExecuteDataset
ÏÏ ,
(
ÏÏ, -
SqlTransaction
ÏÏ- ;
transaction
ÏÏ< G
,
ÏÏG H
CommandType
ÏÏI T
commandType
ÏÏU `
,
ÏÏ` a
string
ÏÏb h
commandText
ÏÏi t
)
ÏÏt u
{
ĞĞ 	
return
ÒÒ 
ExecuteDataset
ÒÒ !
(
ÒÒ! "
transaction
ÒÒ" -
,
ÒÒ- .
commandType
ÒÒ/ :
,
ÒÒ: ;
commandText
ÒÒ< G
,
ÒÒG H
(
ÒÒI J
SqlParameter
ÒÒJ V
[
ÒÒV W
]
ÒÒW X
)
ÒÒX Y
null
ÒÒY ]
)
ÒÒ] ^
;
ÒÒ^ _
}
ÓÓ 	
public
ââ 
static
ââ 
DataSet
ââ 
ExecuteDataset
ââ ,
(
ââ, -
SqlTransaction
ââ- ;
transaction
ââ< G
,
ââG H
CommandType
ââI T
commandType
ââU `
,
ââ` a
string
ââb h
commandText
ââi t
,
âât u
params
ââv |
SqlParameterââ} ‰
[ââ‰ Š
]ââŠ ‹!
commandParametersââŒ 
)ââ 
{
ãã 	
if
ää 
(
ää 
transaction
ää 
==
ää 
null
ää #
)
ää# $
throw
ää% *
new
ää+ .#
ArgumentNullException
ää/ D
(
ääD E
$str
ääE R
)
ääR S
;
ääS T
if
åå 
(
åå 
transaction
åå 
!=
åå 
null
åå #
&&
åå$ &
transaction
åå' 2
.
åå2 3

Connection
åå3 =
==
åå> @
null
ååA E
)
ååE F
throw
ååG L
new
ååM P
ArgumentException
ååQ b
(
ååb c
$strååc ´
,åå´ µ
$stråå¶ Ã
)ååÃ Ä
;ååÄ Å

SqlCommand
èè 
cmd
èè 
=
èè 
new
èè  

SqlCommand
èè! +
(
èè+ ,
)
èè, -
;
èè- .
bool
éé !
mustCloseConnection
éé $
=
éé% &
false
éé' ,
;
éé, -
PrepareCommand
êê 
(
êê 
cmd
êê 
,
êê 
transaction
êê  +
.
êê+ ,

Connection
êê, 6
,
êê6 7
transaction
êê8 C
,
êêC D
commandType
êêE P
,
êêP Q
commandText
êêR ]
,
êê] ^
commandParameters
êê_ p
,
êêp q
out
êêr u"
mustCloseConnectionêêv ‰
)êê‰ Š
;êêŠ ‹
using
íí 
(
íí 
SqlDataAdapter
íí !
da
íí" $
=
íí% &
new
íí' *
SqlDataAdapter
íí+ 9
(
íí9 :
cmd
íí: =
)
íí= >
)
íí> ?
{
îî 
DataSet
ïï 
ds
ïï 
=
ïï 
new
ïï  
DataSet
ïï! (
(
ïï( )
)
ïï) *
;
ïï* +
da
òò 
.
òò 
Fill
òò 
(
òò 
ds
òò 
)
òò 
;
òò 
cmd
õõ 
.
õõ 

Parameters
õõ 
.
õõ 
Clear
õõ $
(
õõ$ %
)
õõ% &
;
õõ& '
return
øø 
ds
øø 
;
øø 
}
ùù 
}
úú 	
public
‹‹ 
static
‹‹ 
DataSet
‹‹ 
ExecuteDataset
‹‹ ,
(
‹‹, -
SqlTransaction
‹‹- ;
transaction
‹‹< G
,
‹‹G H
string
‹‹I O
spName
‹‹P V
,
‹‹V W
params
‹‹X ^
object
‹‹_ e
[
‹‹e f
]
‹‹f g
parameterValues
‹‹h w
)
‹‹w x
{
ŒŒ 	
if
 
(
 
transaction
 
==
 
null
 #
)
# $
throw
% *
new
+ .#
ArgumentNullException
/ D
(
D E
$str
E R
)
R S
;
S T
if
 
(
 
transaction
 
!=
 
null
 #
&&
$ &
transaction
' 2
.
2 3

Connection
3 =
==
> @
null
A E
)
E F
throw
G L
new
M P
ArgumentException
Q b
(
b c
$strc ´
,´ µ
$str¶ Ã
)Ã Ä
;Ä Å
if
 
(
 
spName
 
==
 
null
 
||
 !
spName
" (
.
( )
Length
) /
==
0 2
$num
3 4
)
4 5
throw
6 ;
new
< ?#
ArgumentNullException
@ U
(
U V
$str
V ^
)
^ _
;
_ `
if
’’ 
(
’’ 
(
’’ 
parameterValues
’’  
!=
’’! #
null
’’$ (
)
’’( )
&&
’’* ,
(
’’- .
parameterValues
’’. =
.
’’= >
Length
’’> D
>
’’E F
$num
’’G H
)
’’H I
)
’’I J
{
““ 
SqlParameter
•• 
[
•• 
]
•• 
commandParameters
•• 0
=
••1 2%
SqlHelperParameterCache
••3 J
.
••J K
GetSpParameterSet
••K \
(
••\ ]
transaction
••] h
.
••h i

Connection
••i s
,
••s t
spName
••u {
)
••{ |
;
••| }#
AssignParameterValues
˜˜ %
(
˜˜% &
commandParameters
˜˜& 7
,
˜˜7 8
parameterValues
˜˜9 H
)
˜˜H I
;
˜˜I J
return
›› 
ExecuteDataset
›› %
(
››% &
transaction
››& 1
,
››1 2
CommandType
››3 >
.
››> ?
StoredProcedure
››? N
,
››N O
spName
››P V
,
››V W
commandParameters
››X i
)
››i j
;
››j k
}
œœ 
else
 
{
 
return
   
ExecuteDataset
   %
(
  % &
transaction
  & 1
,
  1 2
CommandType
  3 >
.
  > ?
StoredProcedure
  ? N
,
  N O
spName
  P V
)
  V W
;
  W X
}
¡¡ 
}
¢¢ 	
private
¬¬ 
enum
¬¬ $
SqlConnectionOwnership
¬¬ +
{
­­ 	
Internal
¯¯ 
,
¯¯ 
External
±± 
}
²² 	
private
ÃÃ 
static
ÃÃ 
SqlDataReader
ÃÃ $
ExecuteReader
ÃÃ% 2
(
ÃÃ2 3
SqlConnection
ÃÃ3 @

connection
ÃÃA K
,
ÃÃK L
SqlTransaction
ÃÃM [
transaction
ÃÃ\ g
,
ÃÃg h
CommandType
ÃÃi t
commandTypeÃÃu €
,ÃÃ€ 
stringÃÃ‚ ˆ
commandTextÃÃ‰ ”
,ÃÃ” •
SqlParameterÃÃ– ¢
[ÃÃ¢ £
]ÃÃ£ ¤!
commandParametersÃÃ¥ ¶
,ÃÃ¶ ·&
SqlConnectionOwnershipÃÃ¸ Î#
connectionOwnershipÃÃÏ â
)ÃÃâ ã
{
ÄÄ 	
if
ÅÅ 
(
ÅÅ 

connection
ÅÅ 
==
ÅÅ 
null
ÅÅ "
)
ÅÅ" #
throw
ÅÅ$ )
new
ÅÅ* -#
ArgumentNullException
ÅÅ. C
(
ÅÅC D
$str
ÅÅD P
)
ÅÅP Q
;
ÅÅQ R
bool
ÇÇ !
mustCloseConnection
ÇÇ $
=
ÇÇ% &
false
ÇÇ' ,
;
ÇÇ, -

SqlCommand
ÉÉ 
cmd
ÉÉ 
=
ÉÉ 
new
ÉÉ  

SqlCommand
ÉÉ! +
(
ÉÉ+ ,
)
ÉÉ, -
;
ÉÉ- .
try
ÊÊ 
{
ËË 
PrepareCommand
ÌÌ 
(
ÌÌ 
cmd
ÌÌ "
,
ÌÌ" #

connection
ÌÌ$ .
,
ÌÌ. /
transaction
ÌÌ0 ;
,
ÌÌ; <
commandType
ÌÌ= H
,
ÌÌH I
commandText
ÌÌJ U
,
ÌÌU V
commandParameters
ÌÌW h
,
ÌÌh i
out
ÌÌj m"
mustCloseConnectionÌÌn 
)ÌÌ ‚
;ÌÌ‚ ƒ
SqlDataReader
ÏÏ 

dataReader
ÏÏ (
;
ÏÏ( )
if
ÒÒ 
(
ÒÒ !
connectionOwnership
ÒÒ '
==
ÒÒ( *$
SqlConnectionOwnership
ÒÒ+ A
.
ÒÒA B
External
ÒÒB J
)
ÒÒJ K
{
ÓÓ 

dataReader
ÔÔ 
=
ÔÔ  
cmd
ÔÔ! $
.
ÔÔ$ %
ExecuteReader
ÔÔ% 2
(
ÔÔ2 3
)
ÔÔ3 4
;
ÔÔ4 5
}
ÕÕ 
else
ÖÖ 
{
×× 

dataReader
ØØ 
=
ØØ  
cmd
ØØ! $
.
ØØ$ %
ExecuteReader
ØØ% 2
(
ØØ2 3
CommandBehavior
ØØ3 B
.
ØØB C
CloseConnection
ØØC R
)
ØØR S
;
ØØS T
}
ÙÙ 
bool
àà 
canClear
àà 
=
àà 
true
àà  $
;
àà$ %
foreach
áá 
(
áá 
SqlParameter
áá %
commandParameter
áá& 6
in
áá7 9
cmd
áá: =
.
áá= >

Parameters
áá> H
)
ááH I
{
ââ 
if
ãã 
(
ãã 
commandParameter
ãã (
.
ãã( )
	Direction
ãã) 2
!=
ãã3 5 
ParameterDirection
ãã6 H
.
ããH I
Input
ããI N
)
ããN O
canClear
ää  
=
ää! "
false
ää# (
;
ää( )
}
åå 
if
çç 
(
çç 
canClear
çç 
)
çç 
{
èè 
cmd
éé 
.
éé 

Parameters
éé "
.
éé" #
Clear
éé# (
(
éé( )
)
éé) *
;
éé* +
}
êê 
return
ìì 

dataReader
ìì !
;
ìì! "
}
íí 
catch
îî 
{
ïï 
if
ğğ 
(
ğğ !
mustCloseConnection
ğğ '
)
ğğ' (

connection
ññ 
.
ññ 
Close
ññ $
(
ññ$ %
)
ññ% &
;
ññ& '
throw
òò 
;
òò 
}
óó 
}
ôô 	
private
†† 
static
†† 
SqlDataReader
†† $
ExecuteReader
††% 2
(
††2 3
SqlConnection
††3 @

connection
††A K
,
††K L
SqlTransaction
††M [
transaction
††\ g
,
††g h
CommandType
††i t
commandType††u €
,††€ 
string††‚ ˆ
commandText††‰ ”
,††” •
SqlParameter††– ¢
[††¢ £
]††£ ¤!
commandParameters††¥ ¶
,††¶ ·&
SqlConnectionOwnership††¸ Î#
connectionOwnership††Ï â
,††â ã
int††ä ç

cmdTimeOut††è ò
)††ò ó
{
‡‡ 	
if
ˆˆ 
(
ˆˆ 

connection
ˆˆ 
==
ˆˆ 
null
ˆˆ "
)
ˆˆ" #
throw
ˆˆ$ )
new
ˆˆ* -#
ArgumentNullException
ˆˆ. C
(
ˆˆC D
$str
ˆˆD P
)
ˆˆP Q
;
ˆˆQ R
bool
ŠŠ !
mustCloseConnection
ŠŠ $
=
ŠŠ% &
false
ŠŠ' ,
;
ŠŠ, -

SqlCommand
ŒŒ 
cmd
ŒŒ 
=
ŒŒ 
new
ŒŒ  

SqlCommand
ŒŒ! +
(
ŒŒ+ ,
)
ŒŒ, -
;
ŒŒ- .
try
 
{
 
PrepareCommand
 
(
 
cmd
 "
,
" #

connection
$ .
,
. /
transaction
0 ;
,
; <
commandType
= H
,
H I
commandText
J U
,
U V
commandParameters
W h
,
h i

cmdTimeOut
j t
,
t u
out
v y"
mustCloseConnectionz 
) 
; 
SqlDataReader
’’ 

dataReader
’’ (
;
’’( )
if
•• 
(
•• !
connectionOwnership
•• '
==
••( *$
SqlConnectionOwnership
••+ A
.
••A B
External
••B J
)
••J K
{
–– 

dataReader
—— 
=
——  
cmd
——! $
.
——$ %
ExecuteReader
——% 2
(
——2 3
)
——3 4
;
——4 5
}
˜˜ 
else
™™ 
{
šš 

dataReader
›› 
=
››  
cmd
››! $
.
››$ %
ExecuteReader
››% 2
(
››2 3
CommandBehavior
››3 B
.
››B C
CloseConnection
››C R
)
››R S
;
››S T
}
œœ 
bool
££ 
canClear
££ 
=
££ 
true
££  $
;
££$ %
foreach
¤¤ 
(
¤¤ 
SqlParameter
¤¤ %
commandParameter
¤¤& 6
in
¤¤7 9
cmd
¤¤: =
.
¤¤= >

Parameters
¤¤> H
)
¤¤H I
{
¥¥ 
if
¦¦ 
(
¦¦ 
commandParameter
¦¦ (
.
¦¦( )
	Direction
¦¦) 2
!=
¦¦3 5 
ParameterDirection
¦¦6 H
.
¦¦H I
Input
¦¦I N
)
¦¦N O
canClear
§§  
=
§§! "
false
§§# (
;
§§( )
}
¨¨ 
if
ªª 
(
ªª 
canClear
ªª 
)
ªª 
{
«« 
cmd
¬¬ 
.
¬¬ 

Parameters
¬¬ "
.
¬¬" #
Clear
¬¬# (
(
¬¬( )
)
¬¬) *
;
¬¬* +
}
­­ 
return
¯¯ 

dataReader
¯¯ !
;
¯¯! "
}
°° 
catch
±± 
{
²² 
if
³³ 
(
³³ !
mustCloseConnection
³³ '
)
³³' (

connection
´´ 
.
´´ 
Close
´´ $
(
´´$ %
)
´´% &
;
´´& '
throw
µµ 
;
µµ 
}
¶¶ 
}
·· 	
public
ÅÅ 
static
ÅÅ 
SqlDataReader
ÅÅ #
ExecuteReader
ÅÅ$ 1
(
ÅÅ1 2
string
ÅÅ2 8
connectionString
ÅÅ9 I
,
ÅÅI J
CommandType
ÅÅK V
commandType
ÅÅW b
,
ÅÅb c
string
ÅÅd j
commandText
ÅÅk v
)
ÅÅv w
{
ÆÆ 	
return
ÈÈ 
ExecuteReader
ÈÈ  
(
ÈÈ  !
connectionString
ÈÈ! 1
,
ÈÈ1 2
commandType
ÈÈ3 >
,
ÈÈ> ?
commandText
ÈÈ@ K
,
ÈÈK L
(
ÈÈM N
SqlParameter
ÈÈN Z
[
ÈÈZ [
]
ÈÈ[ \
)
ÈÈ\ ]
null
ÈÈ] a
)
ÈÈa b
;
ÈÈb c
}
ÉÉ 	
public
ØØ 
static
ØØ 
SqlDataReader
ØØ #
ExecuteReader
ØØ$ 1
(
ØØ1 2
string
ØØ2 8
connectionString
ØØ9 I
,
ØØI J
CommandType
ØØK V
commandType
ØØW b
,
ØØb c
string
ØØd j
commandText
ØØk v
,
ØØv w
params
ØØx ~
SqlParameterØØ ‹
[ØØ‹ Œ
]ØØŒ !
commandParametersØØ Ÿ
)ØØŸ  
{
ÙÙ 	
if
ÚÚ 
(
ÚÚ 
connectionString
ÚÚ  
==
ÚÚ! #
null
ÚÚ$ (
||
ÚÚ) +
connectionString
ÚÚ, <
.
ÚÚ< =
Length
ÚÚ= C
==
ÚÚD F
$num
ÚÚG H
)
ÚÚH I
throw
ÚÚJ O
new
ÚÚP S#
ArgumentNullException
ÚÚT i
(
ÚÚi j
$str
ÚÚj |
)
ÚÚ| }
;
ÚÚ} ~
SqlConnection
ÛÛ 

connection
ÛÛ $
=
ÛÛ% &
null
ÛÛ' +
;
ÛÛ+ ,
try
ÜÜ 
{
İİ 

connection
ŞŞ 
=
ŞŞ 
new
ŞŞ  
SqlConnection
ŞŞ! .
(
ŞŞ. /
connectionString
ŞŞ/ ?
)
ŞŞ? @
;
ŞŞ@ A

connection
ßß 
.
ßß 
Open
ßß 
(
ßß  
)
ßß  !
;
ßß! "
return
ââ 
ExecuteReader
ââ $
(
ââ$ %

connection
ââ% /
,
ââ/ 0
null
ââ1 5
,
ââ5 6
commandType
ââ7 B
,
ââB C
commandText
ââD O
,
ââO P
commandParameters
ââQ b
,
ââb c$
SqlConnectionOwnership
ââd z
.
ââz {
Internalââ{ ƒ
)ââƒ „
;ââ„ …
}
ãã 
catch
ää 
{
åå 
if
çç 
(
çç 

connection
çç 
!=
çç !
null
çç" &
)
çç& '

connection
çç( 2
.
çç2 3
Close
çç3 8
(
çç8 9
)
çç9 :
;
çç: ;
throw
èè 
;
èè 
}
éé 
}
ëë 	
public
ûû 
static
ûû 
SqlDataReader
ûû #
ExecuteReader
ûû$ 1
(
ûû1 2
string
ûû2 8
connectionString
ûû9 I
,
ûûI J
CommandType
ûûK V
commandType
ûûW b
,
ûûb c
string
ûûd j
commandText
ûûk v
,
ûûv w
int
ûûx {

cmdTimeOutûû| †
,ûû† ‡
paramsûûˆ 
SqlParameterûû ›
[ûû› œ
]ûûœ !
commandParametersûû ¯
)ûû¯ °
{
üü 	
if
ıı 
(
ıı 
connectionString
ıı  
==
ıı! #
null
ıı$ (
||
ıı) +
connectionString
ıı, <
.
ıı< =
Length
ıı= C
==
ııD F
$num
ııG H
)
ııH I
throw
ııJ O
new
ııP S#
ArgumentNullException
ııT i
(
ııi j
$str
ııj |
)
ıı| }
;
ıı} ~
SqlConnection
şş 

connection
şş $
=
şş% &
null
şş' +
;
şş+ ,
try
ÿÿ 
{
€€ 

connection
 
=
 
new
  
SqlConnection
! .
(
. /
connectionString
/ ?
)
? @
;
@ A

connection
‚‚ 
.
‚‚ 
Open
‚‚ 
(
‚‚  
)
‚‚  !
;
‚‚! "
return
…… 
ExecuteReader
…… $
(
……$ %

connection
……% /
,
……/ 0
null
……1 5
,
……5 6
commandType
……7 B
,
……B C
commandText
……D O
,
……O P
commandParameters
……Q b
,
……b c$
SqlConnectionOwnership
……d z
.
……z {
Internal……{ ƒ
,……ƒ „

cmdTimeOut……… 
)…… 
;…… ‘
}
†† 
catch
‡‡ 
{
ˆˆ 
if
ŠŠ 
(
ŠŠ 

connection
ŠŠ 
!=
ŠŠ !
null
ŠŠ" &
)
ŠŠ& '

connection
ŠŠ( 2
.
ŠŠ2 3
Close
ŠŠ3 8
(
ŠŠ8 9
)
ŠŠ9 :
;
ŠŠ: ;
throw
‹‹ 
;
‹‹ 
}
ŒŒ 
}
 	
public
ŸŸ 
static
ŸŸ 
SqlDataReader
ŸŸ #
ExecuteReader
ŸŸ$ 1
(
ŸŸ1 2
string
ŸŸ2 8
connectionString
ŸŸ9 I
,
ŸŸI J
string
ŸŸK Q
spName
ŸŸR X
,
ŸŸX Y
params
ŸŸZ `
object
ŸŸa g
[
ŸŸg h
]
ŸŸh i
parameterValues
ŸŸj y
)
ŸŸy z
{
   	
if
¡¡ 
(
¡¡ 
connectionString
¡¡  
==
¡¡! #
null
¡¡$ (
||
¡¡) +
connectionString
¡¡, <
.
¡¡< =
Length
¡¡= C
==
¡¡D F
$num
¡¡G H
)
¡¡H I
throw
¡¡J O
new
¡¡P S#
ArgumentNullException
¡¡T i
(
¡¡i j
$str
¡¡j |
)
¡¡| }
;
¡¡} ~
if
¢¢ 
(
¢¢ 
spName
¢¢ 
==
¢¢ 
null
¢¢ 
||
¢¢ !
spName
¢¢" (
.
¢¢( )
Length
¢¢) /
==
¢¢0 2
$num
¢¢3 4
)
¢¢4 5
throw
¢¢6 ;
new
¢¢< ?#
ArgumentNullException
¢¢@ U
(
¢¢U V
$str
¢¢V ^
)
¢¢^ _
;
¢¢_ `
if
¥¥ 
(
¥¥ 
(
¥¥ 
parameterValues
¥¥  
!=
¥¥! #
null
¥¥$ (
)
¥¥( )
&&
¥¥* ,
(
¥¥- .
parameterValues
¥¥. =
.
¥¥= >
Length
¥¥> D
>
¥¥E F
$num
¥¥G H
)
¥¥H I
)
¥¥I J
{
¦¦ 
SqlParameter
§§ 
[
§§ 
]
§§ 
commandParameters
§§ 0
=
§§1 2%
SqlHelperParameterCache
§§3 J
.
§§J K
GetSpParameterSet
§§K \
(
§§\ ]
connectionString
§§] m
,
§§m n
spName
§§o u
)
§§u v
;
§§v w#
AssignParameterValues
©© %
(
©©% &
commandParameters
©©& 7
,
©©7 8
parameterValues
©©9 H
)
©©H I
;
©©I J
return
«« 
ExecuteReader
«« $
(
««$ %
connectionString
««% 5
,
««5 6
CommandType
««7 B
.
««B C
StoredProcedure
««C R
,
««R S
spName
««T Z
,
««Z [
commandParameters
««\ m
)
««m n
;
««n o
}
¬¬ 
else
­­ 
{
®® 
return
°° 
ExecuteReader
°° $
(
°°$ %
connectionString
°°% 5
,
°°5 6
CommandType
°°7 B
.
°°B C
StoredProcedure
°°C R
,
°°R S
spName
°°T Z
)
°°Z [
;
°°[ \
}
±± 
}
²² 	
public
¿¿ 
static
¿¿ 
SqlDataReader
¿¿ #
ExecuteReader
¿¿$ 1
(
¿¿1 2
SqlConnection
¿¿2 ?

connection
¿¿@ J
,
¿¿J K
CommandType
¿¿L W
commandType
¿¿X c
,
¿¿c d
string
¿¿e k
commandText
¿¿l w
)
¿¿w x
{
ÀÀ 	
return
ÂÂ 
ExecuteReader
ÂÂ  
(
ÂÂ  !

connection
ÂÂ! +
,
ÂÂ+ ,
commandType
ÂÂ- 8
,
ÂÂ8 9
commandText
ÂÂ: E
,
ÂÂE F
(
ÂÂG H
SqlParameter
ÂÂH T
[
ÂÂT U
]
ÂÂU V
)
ÂÂV W
null
ÂÂW [
)
ÂÂ[ \
;
ÂÂ\ ]
}
ÃÃ 	
public
ÒÒ 
static
ÒÒ 
SqlDataReader
ÒÒ #
ExecuteReader
ÒÒ$ 1
(
ÒÒ1 2
SqlConnection
ÒÒ2 ?

connection
ÒÒ@ J
,
ÒÒJ K
CommandType
ÒÒL W
commandType
ÒÒX c
,
ÒÒc d
string
ÒÒe k
commandText
ÒÒl w
,
ÒÒw x
params
ÒÒy 
SqlParameterÒÒ€ Œ
[ÒÒŒ 
]ÒÒ !
commandParametersÒÒ  
)ÒÒ  ¡
{
ÓÓ 	
return
ÕÕ 
ExecuteReader
ÕÕ  
(
ÕÕ  !

connection
ÕÕ! +
,
ÕÕ+ ,
(
ÕÕ- .
SqlTransaction
ÕÕ. <
)
ÕÕ< =
null
ÕÕ= A
,
ÕÕA B
commandType
ÕÕC N
,
ÕÕN O
commandText
ÕÕP [
,
ÕÕ[ \
commandParameters
ÕÕ] n
,
ÕÕn o%
SqlConnectionOwnershipÕÕp †
.ÕÕ† ‡
ExternalÕÕ‡ 
)ÕÕ 
;ÕÕ ‘
}
ÖÖ 	
public
çç 
static
çç 
SqlDataReader
çç #
ExecuteReader
çç$ 1
(
çç1 2
SqlConnection
çç2 ?

connection
çç@ J
,
ççJ K
string
ççL R
spName
ççS Y
,
ççY Z
params
çç[ a
object
ççb h
[
ççh i
]
ççi j
parameterValues
ççk z
)
ççz {
{
èè 	
if
éé 
(
éé 

connection
éé 
==
éé 
null
éé "
)
éé" #
throw
éé$ )
new
éé* -#
ArgumentNullException
éé. C
(
ééC D
$str
ééD P
)
ééP Q
;
ééQ R
if
êê 
(
êê 
spName
êê 
==
êê 
null
êê 
||
êê !
spName
êê" (
.
êê( )
Length
êê) /
==
êê0 2
$num
êê3 4
)
êê4 5
throw
êê6 ;
new
êê< ?#
ArgumentNullException
êê@ U
(
êêU V
$str
êêV ^
)
êê^ _
;
êê_ `
if
íí 
(
íí 
(
íí 
parameterValues
íí  
!=
íí! #
null
íí$ (
)
íí( )
&&
íí* ,
(
íí- .
parameterValues
íí. =
.
íí= >
Length
íí> D
>
ííE F
$num
ííG H
)
ííH I
)
ííI J
{
îî 
SqlParameter
ïï 
[
ïï 
]
ïï 
commandParameters
ïï 0
=
ïï1 2%
SqlHelperParameterCache
ïï3 J
.
ïïJ K
GetSpParameterSet
ïïK \
(
ïï\ ]

connection
ïï] g
,
ïïg h
spName
ïïi o
)
ïïo p
;
ïïp q#
AssignParameterValues
ññ %
(
ññ% &
commandParameters
ññ& 7
,
ññ7 8
parameterValues
ññ9 H
)
ññH I
;
ññI J
return
óó 
ExecuteReader
óó $
(
óó$ %

connection
óó% /
,
óó/ 0
CommandType
óó1 <
.
óó< =
StoredProcedure
óó= L
,
óóL M
spName
óóN T
,
óóT U
commandParameters
óóV g
)
óóg h
;
óóh i
}
ôô 
else
õõ 
{
öö 
return
øø 
ExecuteReader
øø $
(
øø$ %

connection
øø% /
,
øø/ 0
CommandType
øø1 <
.
øø< =
StoredProcedure
øø= L
,
øøL M
spName
øøN T
)
øøT U
;
øøU V
}
ùù 
}
úú 	
public
‡	‡	 
static
‡	‡	 
SqlDataReader
‡	‡	 #
ExecuteReader
‡	‡	$ 1
(
‡	‡	1 2
SqlTransaction
‡	‡	2 @
transaction
‡	‡	A L
,
‡	‡	L M
CommandType
‡	‡	N Y
commandType
‡	‡	Z e
,
‡	‡	e f
string
‡	‡	g m
commandText
‡	‡	n y
)
‡	‡	y z
{
ˆ	ˆ	 	
return
Š	Š	 
ExecuteReader
Š	Š	  
(
Š	Š	  !
transaction
Š	Š	! ,
,
Š	Š	, -
commandType
Š	Š	. 9
,
Š	Š	9 :
commandText
Š	Š	; F
,
Š	Š	F G
(
Š	Š	H I
SqlParameter
Š	Š	I U
[
Š	Š	U V
]
Š	Š	V W
)
Š	Š	W X
null
Š	Š	X \
)
Š	Š	\ ]
;
Š	Š	] ^
}
‹	‹	 	
public
š	š	 
static
š	š	 
SqlDataReader
š	š	 #
ExecuteReader
š	š	$ 1
(
š	š	1 2
SqlTransaction
š	š	2 @
transaction
š	š	A L
,
š	š	L M
CommandType
š	š	N Y
commandType
š	š	Z e
,
š	š	e f
string
š	š	g m
commandText
š	š	n y
,
š	š	y z
paramsš	š	{ 
SqlParameterš	š	‚ 
[š	š	 
]š	š	 !
commandParametersš	š	‘ ¢
)š	š	¢ £
{
›	›	 	
if
œ	œ	 
(
œ	œ	 
transaction
œ	œ	 
==
œ	œ	 
null
œ	œ	 #
)
œ	œ	# $
throw
œ	œ	% *
new
œ	œ	+ .#
ArgumentNullException
œ	œ	/ D
(
œ	œ	D E
$str
œ	œ	E R
)
œ	œ	R S
;
œ	œ	S T
if
		 
(
		 
transaction
		 
!=
		 
null
		 #
&&
		$ &
transaction
		' 2
.
		2 3

Connection
		3 =
==
		> @
null
		A E
)
		E F
throw
		G L
new
		M P
ArgumentException
		Q b
(
		b c
$str		c ´
,		´ µ
$str		¶ Ã
)		Ã Ä
;		Ä Å
return
 	 	 
ExecuteReader
 	 	  
(
 	 	  !
transaction
 	 	! ,
.
 	 	, -

Connection
 	 	- 7
,
 	 	7 8
transaction
 	 	9 D
,
 	 	D E
commandType
 	 	F Q
,
 	 	Q R
commandText
 	 	S ^
,
 	 	^ _
commandParameters
 	 	` q
,
 	 	q r%
SqlConnectionOwnership 	 	s ‰
. 	 	‰ Š
External 	 	Š ’
) 	 	’ “
; 	 	“ ”
}
¡	¡	 	
public
²	²	 
static
²	²	 
SqlDataReader
²	²	 #
ExecuteReader
²	²	$ 1
(
²	²	1 2
SqlTransaction
²	²	2 @
transaction
²	²	A L
,
²	²	L M
string
²	²	N T
spName
²	²	U [
,
²	²	[ \
params
²	²	] c
object
²	²	d j
[
²	²	j k
]
²	²	k l
parameterValues
²	²	m |
)
²	²	| }
{
³	³	 	
if
´	´	 
(
´	´	 
transaction
´	´	 
==
´	´	 
null
´	´	 #
)
´	´	# $
throw
´	´	% *
new
´	´	+ .#
ArgumentNullException
´	´	/ D
(
´	´	D E
$str
´	´	E R
)
´	´	R S
;
´	´	S T
if
µ	µ	 
(
µ	µ	 
transaction
µ	µ	 
!=
µ	µ	 
null
µ	µ	 #
&&
µ	µ	$ &
transaction
µ	µ	' 2
.
µ	µ	2 3

Connection
µ	µ	3 =
==
µ	µ	> @
null
µ	µ	A E
)
µ	µ	E F
throw
µ	µ	G L
new
µ	µ	M P
ArgumentException
µ	µ	Q b
(
µ	µ	b c
$strµ	µ	c ´
,µ	µ	´ µ
$strµ	µ	¶ Ã
)µ	µ	Ã Ä
;µ	µ	Ä Å
if
¶	¶	 
(
¶	¶	 
spName
¶	¶	 
==
¶	¶	 
null
¶	¶	 
||
¶	¶	 !
spName
¶	¶	" (
.
¶	¶	( )
Length
¶	¶	) /
==
¶	¶	0 2
$num
¶	¶	3 4
)
¶	¶	4 5
throw
¶	¶	6 ;
new
¶	¶	< ?#
ArgumentNullException
¶	¶	@ U
(
¶	¶	U V
$str
¶	¶	V ^
)
¶	¶	^ _
;
¶	¶	_ `
if
¹	¹	 
(
¹	¹	 
(
¹	¹	 
parameterValues
¹	¹	  
!=
¹	¹	! #
null
¹	¹	$ (
)
¹	¹	( )
&&
¹	¹	* ,
(
¹	¹	- .
parameterValues
¹	¹	. =
.
¹	¹	= >
Length
¹	¹	> D
>
¹	¹	E F
$num
¹	¹	G H
)
¹	¹	H I
)
¹	¹	I J
{
º	º	 
SqlParameter
»	»	 
[
»	»	 
]
»	»	 
commandParameters
»	»	 0
=
»	»	1 2%
SqlHelperParameterCache
»	»	3 J
.
»	»	J K
GetSpParameterSet
»	»	K \
(
»	»	\ ]
transaction
»	»	] h
.
»	»	h i

Connection
»	»	i s
,
»	»	s t
spName
»	»	u {
)
»	»	{ |
;
»	»	| }#
AssignParameterValues
½	½	 %
(
½	½	% &
commandParameters
½	½	& 7
,
½	½	7 8
parameterValues
½	½	9 H
)
½	½	H I
;
½	½	I J
return
¿	¿	 
ExecuteReader
¿	¿	 $
(
¿	¿	$ %
transaction
¿	¿	% 0
,
¿	¿	0 1
CommandType
¿	¿	2 =
.
¿	¿	= >
StoredProcedure
¿	¿	> M
,
¿	¿	M N
spName
¿	¿	O U
,
¿	¿	U V
commandParameters
¿	¿	W h
)
¿	¿	h i
;
¿	¿	i j
}
À	À	 
else
Á	Á	 
{
Â	Â	 
return
Ä	Ä	 
ExecuteReader
Ä	Ä	 $
(
Ä	Ä	$ %
transaction
Ä	Ä	% 0
,
Ä	Ä	0 1
CommandType
Ä	Ä	2 =
.
Ä	Ä	= >
StoredProcedure
Ä	Ä	> M
,
Ä	Ä	M N
spName
Ä	Ä	O U
)
Ä	Ä	U V
;
Ä	Ä	V W
}
Å	Å	 
}
Æ	Æ	 	
public
Ø	Ø	 
static
Ø	Ø	 
object
Ø	Ø	 
ExecuteScalar
Ø	Ø	 *
(
Ø	Ø	* +
string
Ø	Ø	+ 1
connectionString
Ø	Ø	2 B
,
Ø	Ø	B C
CommandType
Ø	Ø	D O
commandType
Ø	Ø	P [
,
Ø	Ø	[ \
string
Ø	Ø	] c
commandText
Ø	Ø	d o
)
Ø	Ø	o p
{
Ù	Ù	 	
return
Û	Û	 
ExecuteScalar
Û	Û	  
(
Û	Û	  !
connectionString
Û	Û	! 1
,
Û	Û	1 2
commandType
Û	Û	3 >
,
Û	Û	> ?
commandText
Û	Û	@ K
,
Û	Û	K L
(
Û	Û	M N
SqlParameter
Û	Û	N Z
[
Û	Û	Z [
]
Û	Û	[ \
)
Û	Û	\ ]
null
Û	Û	] a
)
Û	Û	a b
;
Û	Û	b c
}
Ü	Ü	 	
public
ë	ë	 
static
ë	ë	 
object
ë	ë	 
ExecuteScalar
ë	ë	 *
(
ë	ë	* +
string
ë	ë	+ 1
connectionString
ë	ë	2 B
,
ë	ë	B C
CommandType
ë	ë	D O
commandType
ë	ë	P [
,
ë	ë	[ \
string
ë	ë	] c
commandText
ë	ë	d o
,
ë	ë	o p
params
ë	ë	q w
SqlParameterë	ë	x „
[ë	ë	„ …
]ë	ë	… †!
commandParametersë	ë	‡ ˜
)ë	ë	˜ ™
{
ì	ì	 	
if
í	í	 
(
í	í	 
connectionString
í	í	  
==
í	í	! #
null
í	í	$ (
||
í	í	) +
connectionString
í	í	, <
.
í	í	< =
Length
í	í	= C
==
í	í	D F
$num
í	í	G H
)
í	í	H I
throw
í	í	J O
new
í	í	P S#
ArgumentNullException
í	í	T i
(
í	í	i j
$str
í	í	j |
)
í	í	| }
;
í	í	} ~
using
ï	ï	 
(
ï	ï	 
SqlConnection
ï	ï	  

connection
ï	ï	! +
=
ï	ï	, -
new
ï	ï	. 1
SqlConnection
ï	ï	2 ?
(
ï	ï	? @
connectionString
ï	ï	@ P
)
ï	ï	P Q
)
ï	ï	Q R
{
ğ	ğ	 

connection
ñ	ñ	 
.
ñ	ñ	 
Open
ñ	ñ	 
(
ñ	ñ	  
)
ñ	ñ	  !
;
ñ	ñ	! "
return
ô	ô	 
ExecuteScalar
ô	ô	 $
(
ô	ô	$ %

connection
ô	ô	% /
,
ô	ô	/ 0
commandType
ô	ô	1 <
,
ô	ô	< =
commandText
ô	ô	> I
,
ô	ô	I J
commandParameters
ô	ô	K \
)
ô	ô	\ ]
;
ô	ô	] ^
}
õ	õ	 
}
ö	ö	 	
public
‡
‡
 
static
‡
‡
 
object
‡
‡
 
ExecuteScalar
‡
‡
 *
(
‡
‡
* +
string
‡
‡
+ 1
connectionString
‡
‡
2 B
,
‡
‡
B C
string
‡
‡
D J
spName
‡
‡
K Q
,
‡
‡
Q R
params
‡
‡
S Y
object
‡
‡
Z `
[
‡
‡
` a
]
‡
‡
a b
parameterValues
‡
‡
c r
)
‡
‡
r s
{
ˆ
ˆ
 	
if
‰
‰
 
(
‰
‰
 
connectionString
‰
‰
  
==
‰
‰
! #
null
‰
‰
$ (
||
‰
‰
) +
connectionString
‰
‰
, <
.
‰
‰
< =
Length
‰
‰
= C
==
‰
‰
D F
$num
‰
‰
G H
)
‰
‰
H I
throw
‰
‰
J O
new
‰
‰
P S#
ArgumentNullException
‰
‰
T i
(
‰
‰
i j
$str
‰
‰
j |
)
‰
‰
| }
;
‰
‰
} ~
if
Š
Š
 
(
Š
Š
 
spName
Š
Š
 
==
Š
Š
 
null
Š
Š
 
||
Š
Š
 !
spName
Š
Š
" (
.
Š
Š
( )
Length
Š
Š
) /
==
Š
Š
0 2
$num
Š
Š
3 4
)
Š
Š
4 5
throw
Š
Š
6 ;
new
Š
Š
< ?#
ArgumentNullException
Š
Š
@ U
(
Š
Š
U V
$str
Š
Š
V ^
)
Š
Š
^ _
;
Š
Š
_ `
if


 
(


 
(


 
parameterValues


  
!=


! #
null


$ (
)


( )
&&


* ,
(


- .
parameterValues


. =
.


= >
Length


> D
>


E F
$num


G H
)


H I
)


I J
{


 
SqlParameter


 
[


 
]


 
commandParameters


 0
=


1 2%
SqlHelperParameterCache


3 J
.


J K
GetSpParameterSet


K \
(


\ ]
connectionString


] m
,


m n
spName


o u
)


u v
;


v w#
AssignParameterValues
“
“
 %
(
“
“
% &
commandParameters
“
“
& 7
,
“
“
7 8
parameterValues
“
“
9 H
)
“
“
H I
;
“
“
I J
return
–
–
 
ExecuteScalar
–
–
 $
(
–
–
$ %
connectionString
–
–
% 5
,
–
–
5 6
CommandType
–
–
7 B
.
–
–
B C
StoredProcedure
–
–
C R
,
–
–
R S
spName
–
–
T Z
,
–
–
Z [
commandParameters
–
–
\ m
)
–
–
m n
;
–
–
n o
}
—
—
 
else
˜
˜
 
{
™
™
 
return
›
›
 
ExecuteScalar
›
›
 $
(
›
›
$ %
connectionString
›
›
% 5
,
›
›
5 6
CommandType
›
›
7 B
.
›
›
B C
StoredProcedure
›
›
C R
,
›
›
R S
spName
›
›
T Z
)
›
›
Z [
;
›
›
[ \
}
œ
œ
 
}


 	
public
ª
ª
 
static
ª
ª
 
object
ª
ª
 
ExecuteScalar
ª
ª
 *
(
ª
ª
* +
SqlConnection
ª
ª
+ 8

connection
ª
ª
9 C
,
ª
ª
C D
CommandType
ª
ª
E P
commandType
ª
ª
Q \
,
ª
ª
\ ]
string
ª
ª
^ d
commandText
ª
ª
e p
)
ª
ª
p q
{
«
«
 	
return
­
­
 
ExecuteScalar
­
­
  
(
­
­
  !

connection
­
­
! +
,
­
­
+ ,
commandType
­
­
- 8
,
­
­
8 9
commandText
­
­
: E
,
­
­
E F
(
­
­
G H
SqlParameter
­
­
H T
[
­
­
T U
]
­
­
U V
)
­
­
V W
null
­
­
W [
)
­
­
[ \
;
­
­
\ ]
}
®
®
 	
public
½
½
 
static
½
½
 
object
½
½
 
ExecuteScalar
½
½
 *
(
½
½
* +
SqlConnection
½
½
+ 8

connection
½
½
9 C
,
½
½
C D
CommandType
½
½
E P
commandType
½
½
Q \
,
½
½
\ ]
string
½
½
^ d
commandText
½
½
e p
,
½
½
p q
params
½
½
r x
SqlParameter½
½
y …
[½
½
… †
]½
½
† ‡!
commandParameters½
½
ˆ ™
)½
½
™ š
{
¾
¾
 	
if
¿
¿
 
(
¿
¿
 

connection
¿
¿
 
==
¿
¿
 
null
¿
¿
 "
)
¿
¿
" #
throw
¿
¿
$ )
new
¿
¿
* -#
ArgumentNullException
¿
¿
. C
(
¿
¿
C D
$str
¿
¿
D P
)
¿
¿
P Q
;
¿
¿
Q R

SqlCommand
Â
Â
 
cmd
Â
Â
 
=
Â
Â
 
new
Â
Â
  

SqlCommand
Â
Â
! +
(
Â
Â
+ ,
)
Â
Â
, -
;
Â
Â
- .
bool
Ä
Ä
 !
mustCloseConnection
Ä
Ä
 $
=
Ä
Ä
% &
false
Ä
Ä
' ,
;
Ä
Ä
, -
PrepareCommand
Å
Å
 
(
Å
Å
 
cmd
Å
Å
 
,
Å
Å
 

connection
Å
Å
  *
,
Å
Å
* +
(
Å
Å
, -
SqlTransaction
Å
Å
- ;
)
Å
Å
; <
null
Å
Å
< @
,
Å
Å
@ A
commandType
Å
Å
B M
,
Å
Å
M N
commandText
Å
Å
O Z
,
Å
Å
Z [
commandParameters
Å
Å
\ m
,
Å
Å
m n
out
Å
Å
o r"
mustCloseConnectionÅ
Å
s †
)Å
Å
† ‡
;Å
Å
‡ ˆ
object
È
È
 
retval
È
È
 
=
È
È
 
cmd
È
È
 
.
È
È
  
ExecuteScalar
È
È
  -
(
È
È
- .
)
È
È
. /
;
È
È
/ 0
cmd
Ë
Ë
 
.
Ë
Ë
 

Parameters
Ë
Ë
 
.
Ë
Ë
 
Clear
Ë
Ë
  
(
Ë
Ë
  !
)
Ë
Ë
! "
;
Ë
Ë
" #
if
Í
Í
 
(
Í
Í
 !
mustCloseConnection
Í
Í
 #
)
Í
Í
# $

connection
Î
Î
 
.
Î
Î
 
Close
Î
Î
  
(
Î
Î
  !
)
Î
Î
! "
;
Î
Î
" #
return
Ğ
Ğ
 
retval
Ğ
Ğ
 
;
Ğ
Ğ
 
}
Ñ
Ñ
 	
public
â
â
 
static
â
â
 
object
â
â
 
ExecuteScalar
â
â
 *
(
â
â
* +
SqlConnection
â
â
+ 8

connection
â
â
9 C
,
â
â
C D
string
â
â
E K
spName
â
â
L R
,
â
â
R S
params
â
â
T Z
object
â
â
[ a
[
â
â
a b
]
â
â
b c
parameterValues
â
â
d s
)
â
â
s t
{
ã
ã
 	
if
ä
ä
 
(
ä
ä
 

connection
ä
ä
 
==
ä
ä
 
null
ä
ä
 "
)
ä
ä
" #
throw
ä
ä
$ )
new
ä
ä
* -#
ArgumentNullException
ä
ä
. C
(
ä
ä
C D
$str
ä
ä
D P
)
ä
ä
P Q
;
ä
ä
Q R
if
å
å
 
(
å
å
 
spName
å
å
 
==
å
å
 
null
å
å
 
||
å
å
 !
spName
å
å
" (
.
å
å
( )
Length
å
å
) /
==
å
å
0 2
$num
å
å
3 4
)
å
å
4 5
throw
å
å
6 ;
new
å
å
< ?#
ArgumentNullException
å
å
@ U
(
å
å
U V
$str
å
å
V ^
)
å
å
^ _
;
å
å
_ `
if
è
è
 
(
è
è
 
(
è
è
 
parameterValues
è
è
  
!=
è
è
! #
null
è
è
$ (
)
è
è
( )
&&
è
è
* ,
(
è
è
- .
parameterValues
è
è
. =
.
è
è
= >
Length
è
è
> D
>
è
è
E F
$num
è
è
G H
)
è
è
H I
)
è
è
I J
{
é
é
 
SqlParameter
ë
ë
 
[
ë
ë
 
]
ë
ë
 
commandParameters
ë
ë
 0
=
ë
ë
1 2%
SqlHelperParameterCache
ë
ë
3 J
.
ë
ë
J K
GetSpParameterSet
ë
ë
K \
(
ë
ë
\ ]

connection
ë
ë
] g
,
ë
ë
g h
spName
ë
ë
i o
)
ë
ë
o p
;
ë
ë
p q#
AssignParameterValues
î
î
 %
(
î
î
% &
commandParameters
î
î
& 7
,
î
î
7 8
parameterValues
î
î
9 H
)
î
î
H I
;
î
î
I J
return
ñ
ñ
 
ExecuteScalar
ñ
ñ
 $
(
ñ
ñ
$ %

connection
ñ
ñ
% /
,
ñ
ñ
/ 0
CommandType
ñ
ñ
1 <
.
ñ
ñ
< =
StoredProcedure
ñ
ñ
= L
,
ñ
ñ
L M
spName
ñ
ñ
N T
,
ñ
ñ
T U
commandParameters
ñ
ñ
V g
)
ñ
ñ
g h
;
ñ
ñ
h i
}
ò
ò
 
else
ó
ó
 
{
ô
ô
 
return
ö
ö
 
ExecuteScalar
ö
ö
 $
(
ö
ö
$ %

connection
ö
ö
% /
,
ö
ö
/ 0
CommandType
ö
ö
1 <
.
ö
ö
< =
StoredProcedure
ö
ö
= L
,
ö
ö
L M
spName
ö
ö
N T
)
ö
ö
T U
;
ö
ö
U V
}
÷
÷
 
}
ø
ø
 	
public
…… 
static
…… 
object
…… 
ExecuteScalar
…… *
(
……* +
SqlTransaction
……+ 9
transaction
……: E
,
……E F
CommandType
……G R
commandType
……S ^
,
……^ _
string
……` f
commandText
……g r
)
……r s
{
†† 	
return
ˆˆ 
ExecuteScalar
ˆˆ  
(
ˆˆ  !
transaction
ˆˆ! ,
,
ˆˆ, -
commandType
ˆˆ. 9
,
ˆˆ9 :
commandText
ˆˆ; F
,
ˆˆF G
(
ˆˆH I
SqlParameter
ˆˆI U
[
ˆˆU V
]
ˆˆV W
)
ˆˆW X
null
ˆˆX \
)
ˆˆ\ ]
;
ˆˆ] ^
}
‰‰ 	
public
˜˜ 
static
˜˜ 
object
˜˜ 
ExecuteScalar
˜˜ *
(
˜˜* +
SqlTransaction
˜˜+ 9
transaction
˜˜: E
,
˜˜E F
CommandType
˜˜G R
commandType
˜˜S ^
,
˜˜^ _
string
˜˜` f
commandText
˜˜g r
,
˜˜r s
params
˜˜t z
SqlParameter˜˜{ ‡
[˜˜‡ ˆ
]˜˜ˆ ‰!
commandParameters˜˜Š ›
)˜˜› œ
{
™™ 	
if
šš 
(
šš 
transaction
šš 
==
šš 
null
šš #
)
šš# $
throw
šš% *
new
šš+ .#
ArgumentNullException
šš/ D
(
ššD E
$str
ššE R
)
ššR S
;
ššS T
if
›› 
(
›› 
transaction
›› 
!=
›› 
null
›› #
&&
››$ &
transaction
››' 2
.
››2 3

Connection
››3 =
==
››> @
null
››A E
)
››E F
throw
››G L
new
››M P
ArgumentException
››Q b
(
››b c
$str››c ´
,››´ µ
$str››¶ Ã
)››Ã Ä
;››Ä Å

SqlCommand
 
cmd
 
=
 
new
  

SqlCommand
! +
(
+ ,
)
, -
;
- .
bool
ŸŸ !
mustCloseConnection
ŸŸ $
=
ŸŸ% &
false
ŸŸ' ,
;
ŸŸ, -
PrepareCommand
   
(
   
cmd
   
,
   
transaction
    +
.
  + ,

Connection
  , 6
,
  6 7
transaction
  8 C
,
  C D
commandType
  E P
,
  P Q
commandText
  R ]
,
  ] ^
commandParameters
  _ p
,
  p q
out
  r u"
mustCloseConnection  v ‰
)  ‰ Š
;  Š ‹
object
££ 
retval
££ 
=
££ 
cmd
££ 
.
££  
ExecuteScalar
££  -
(
££- .
)
££. /
;
££/ 0
cmd
¦¦ 
.
¦¦ 

Parameters
¦¦ 
.
¦¦ 
Clear
¦¦  
(
¦¦  !
)
¦¦! "
;
¦¦" #
return
§§ 
retval
§§ 
;
§§ 
}
¨¨ 	
public
¹¹ 
static
¹¹ 
object
¹¹ 
ExecuteScalar
¹¹ *
(
¹¹* +
SqlTransaction
¹¹+ 9
transaction
¹¹: E
,
¹¹E F
string
¹¹G M
spName
¹¹N T
,
¹¹T U
params
¹¹V \
object
¹¹] c
[
¹¹c d
]
¹¹d e
parameterValues
¹¹f u
)
¹¹u v
{
ºº 	
if
»» 
(
»» 
transaction
»» 
==
»» 
null
»» #
)
»»# $
throw
»»% *
new
»»+ .#
ArgumentNullException
»»/ D
(
»»D E
$str
»»E R
)
»»R S
;
»»S T
if
¼¼ 
(
¼¼ 
transaction
¼¼ 
!=
¼¼ 
null
¼¼ #
&&
¼¼$ &
transaction
¼¼' 2
.
¼¼2 3

Connection
¼¼3 =
==
¼¼> @
null
¼¼A E
)
¼¼E F
throw
¼¼G L
new
¼¼M P
ArgumentException
¼¼Q b
(
¼¼b c
$str¼¼c ´
,¼¼´ µ
$str¼¼¶ Ã
)¼¼Ã Ä
;¼¼Ä Å
if
½½ 
(
½½ 
spName
½½ 
==
½½ 
null
½½ 
||
½½ !
spName
½½" (
.
½½( )
Length
½½) /
==
½½0 2
$num
½½3 4
)
½½4 5
throw
½½6 ;
new
½½< ?#
ArgumentNullException
½½@ U
(
½½U V
$str
½½V ^
)
½½^ _
;
½½_ `
if
ÀÀ 
(
ÀÀ 
(
ÀÀ 
parameterValues
ÀÀ  
!=
ÀÀ! #
null
ÀÀ$ (
)
ÀÀ( )
&&
ÀÀ* ,
(
ÀÀ- .
parameterValues
ÀÀ. =
.
ÀÀ= >
Length
ÀÀ> D
>
ÀÀE F
$num
ÀÀG H
)
ÀÀH I
)
ÀÀI J
{
ÁÁ 
SqlParameter
ÃÃ 
[
ÃÃ 
]
ÃÃ 
commandParameters
ÃÃ 0
=
ÃÃ1 2%
SqlHelperParameterCache
ÃÃ3 J
.
ÃÃJ K
GetSpParameterSet
ÃÃK \
(
ÃÃ\ ]
transaction
ÃÃ] h
.
ÃÃh i

Connection
ÃÃi s
,
ÃÃs t
spName
ÃÃu {
)
ÃÃ{ |
;
ÃÃ| }#
AssignParameterValues
ÆÆ %
(
ÆÆ% &
commandParameters
ÆÆ& 7
,
ÆÆ7 8
parameterValues
ÆÆ9 H
)
ÆÆH I
;
ÆÆI J
return
ÉÉ 
ExecuteScalar
ÉÉ $
(
ÉÉ$ %
transaction
ÉÉ% 0
,
ÉÉ0 1
CommandType
ÉÉ2 =
.
ÉÉ= >
StoredProcedure
ÉÉ> M
,
ÉÉM N
spName
ÉÉO U
,
ÉÉU V
commandParameters
ÉÉW h
)
ÉÉh i
;
ÉÉi j
}
ÊÊ 
else
ËË 
{
ÌÌ 
return
ÎÎ 
ExecuteScalar
ÎÎ $
(
ÎÎ$ %
transaction
ÎÎ% 0
,
ÎÎ0 1
CommandType
ÎÎ2 =
.
ÎÎ= >
StoredProcedure
ÎÎ> M
,
ÎÎM N
spName
ÎÎO U
)
ÎÎU V
;
ÎÎV W
}
ÏÏ 
}
ĞĞ 	
public
àà 
static
àà 
	XmlReader
àà 
ExecuteXmlReader
àà  0
(
àà0 1
SqlConnection
àà1 >

connection
àà? I
,
ààI J
CommandType
ààK V
commandType
ààW b
,
ààb c
string
ààd j
commandText
ààk v
)
ààv w
{
áá 	
return
ãã 
ExecuteXmlReader
ãã #
(
ãã# $

connection
ãã$ .
,
ãã. /
commandType
ãã0 ;
,
ãã; <
commandText
ãã= H
,
ããH I
(
ããJ K
SqlParameter
ããK W
[
ããW X
]
ããX Y
)
ããY Z
null
ããZ ^
)
ãã^ _
;
ãã_ `
}
ää 	
public
óó 
static
óó 
	XmlReader
óó 
ExecuteXmlReader
óó  0
(
óó0 1
SqlConnection
óó1 >

connection
óó? I
,
óóI J
CommandType
óóK V
commandType
óóW b
,
óób c
string
óód j
commandText
óók v
,
óóv w
params
óóx ~
SqlParameteróó ‹
[óó‹ Œ
]óóŒ !
commandParametersóó Ÿ
)óóŸ  
{
ôô 	
if
õõ 
(
õõ 

connection
õõ 
==
õõ 
null
õõ "
)
õõ" #
throw
õõ$ )
new
õõ* -#
ArgumentNullException
õõ. C
(
õõC D
$str
õõD P
)
õõP Q
;
õõQ R
bool
÷÷ !
mustCloseConnection
÷÷ $
=
÷÷% &
false
÷÷' ,
;
÷÷, -

SqlCommand
ùù 
cmd
ùù 
=
ùù 
new
ùù  

SqlCommand
ùù! +
(
ùù+ ,
)
ùù, -
;
ùù- .
try
úú 
{
ûû 
PrepareCommand
üü 
(
üü 
cmd
üü "
,
üü" #

connection
üü$ .
,
üü. /
(
üü0 1
SqlTransaction
üü1 ?
)
üü? @
null
üü@ D
,
üüD E
commandType
üüF Q
,
üüQ R
commandText
üüS ^
,
üü^ _
commandParameters
üü` q
,
üüq r
out
üüs v"
mustCloseConnectionüüw Š
)üüŠ ‹
;üü‹ Œ
	XmlReader
ÿÿ 
retval
ÿÿ  
=
ÿÿ! "
cmd
ÿÿ# &
.
ÿÿ& '
ExecuteXmlReader
ÿÿ' 7
(
ÿÿ7 8
)
ÿÿ8 9
;
ÿÿ9 :
cmd
‚‚ 
.
‚‚ 

Parameters
‚‚ 
.
‚‚ 
Clear
‚‚ $
(
‚‚$ %
)
‚‚% &
;
‚‚& '
return
„„ 
retval
„„ 
;
„„ 
}
…… 
catch
†† 
{
‡‡ 
if
ˆˆ 
(
ˆˆ !
mustCloseConnection
ˆˆ '
)
ˆˆ' (

connection
‰‰ 
.
‰‰ 
Close
‰‰ $
(
‰‰$ %
)
‰‰% &
;
‰‰& '
throw
ŠŠ 
;
ŠŠ 
}
‹‹ 
}
ŒŒ 	
public
 
static
 
	XmlReader
 
ExecuteXmlReader
  0
(
0 1
SqlConnection
1 >

connection
? I
,
I J
string
K Q
spName
R X
,
X Y
params
Z `
object
a g
[
g h
]
h i
parameterValues
j y
)
y z
{
 	
if
ŸŸ 
(
ŸŸ 

connection
ŸŸ 
==
ŸŸ 
null
ŸŸ "
)
ŸŸ" #
throw
ŸŸ$ )
new
ŸŸ* -#
ArgumentNullException
ŸŸ. C
(
ŸŸC D
$str
ŸŸD P
)
ŸŸP Q
;
ŸŸQ R
if
   
(
   
spName
   
==
   
null
   
||
   !
spName
  " (
.
  ( )
Length
  ) /
==
  0 2
$num
  3 4
)
  4 5
throw
  6 ;
new
  < ?#
ArgumentNullException
  @ U
(
  U V
$str
  V ^
)
  ^ _
;
  _ `
if
££ 
(
££ 
(
££ 
parameterValues
££  
!=
££! #
null
££$ (
)
££( )
&&
££* ,
(
££- .
parameterValues
££. =
.
££= >
Length
££> D
>
££E F
$num
££G H
)
££H I
)
££I J
{
¤¤ 
SqlParameter
¦¦ 
[
¦¦ 
]
¦¦ 
commandParameters
¦¦ 0
=
¦¦1 2%
SqlHelperParameterCache
¦¦3 J
.
¦¦J K
GetSpParameterSet
¦¦K \
(
¦¦\ ]

connection
¦¦] g
,
¦¦g h
spName
¦¦i o
)
¦¦o p
;
¦¦p q#
AssignParameterValues
©© %
(
©©% &
commandParameters
©©& 7
,
©©7 8
parameterValues
©©9 H
)
©©H I
;
©©I J
return
¬¬ 
ExecuteXmlReader
¬¬ '
(
¬¬' (

connection
¬¬( 2
,
¬¬2 3
CommandType
¬¬4 ?
.
¬¬? @
StoredProcedure
¬¬@ O
,
¬¬O P
spName
¬¬Q W
,
¬¬W X
commandParameters
¬¬Y j
)
¬¬j k
;
¬¬k l
}
­­ 
else
®® 
{
¯¯ 
return
±± 
ExecuteXmlReader
±± '
(
±±' (

connection
±±( 2
,
±±2 3
CommandType
±±4 ?
.
±±? @
StoredProcedure
±±@ O
,
±±O P
spName
±±Q W
)
±±W X
;
±±X Y
}
²² 
}
³³ 	
public
ÀÀ 
static
ÀÀ 
	XmlReader
ÀÀ 
ExecuteXmlReader
ÀÀ  0
(
ÀÀ0 1
SqlTransaction
ÀÀ1 ?
transaction
ÀÀ@ K
,
ÀÀK L
CommandType
ÀÀM X
commandType
ÀÀY d
,
ÀÀd e
string
ÀÀf l
commandText
ÀÀm x
)
ÀÀx y
{
ÁÁ 	
return
ÃÃ 
ExecuteXmlReader
ÃÃ #
(
ÃÃ# $
transaction
ÃÃ$ /
,
ÃÃ/ 0
commandType
ÃÃ1 <
,
ÃÃ< =
commandText
ÃÃ> I
,
ÃÃI J
(
ÃÃK L
SqlParameter
ÃÃL X
[
ÃÃX Y
]
ÃÃY Z
)
ÃÃZ [
null
ÃÃ[ _
)
ÃÃ_ `
;
ÃÃ` a
}
ÄÄ 	
public
ÓÓ 
static
ÓÓ 
	XmlReader
ÓÓ 
ExecuteXmlReader
ÓÓ  0
(
ÓÓ0 1
SqlTransaction
ÓÓ1 ?
transaction
ÓÓ@ K
,
ÓÓK L
CommandType
ÓÓM X
commandType
ÓÓY d
,
ÓÓd e
string
ÓÓf l
commandText
ÓÓm x
,
ÓÓx y
paramsÓÓz €
SqlParameterÓÓ 
[ÓÓ 
]ÓÓ !
commandParametersÓÓ ¡
)ÓÓ¡ ¢
{
ÔÔ 	
if
ÕÕ 
(
ÕÕ 
transaction
ÕÕ 
==
ÕÕ 
null
ÕÕ #
)
ÕÕ# $
throw
ÕÕ% *
new
ÕÕ+ .#
ArgumentNullException
ÕÕ/ D
(
ÕÕD E
$str
ÕÕE R
)
ÕÕR S
;
ÕÕS T
if
ÖÖ 
(
ÖÖ 
transaction
ÖÖ 
!=
ÖÖ 
null
ÖÖ #
&&
ÖÖ$ &
transaction
ÖÖ' 2
.
ÖÖ2 3

Connection
ÖÖ3 =
==
ÖÖ> @
null
ÖÖA E
)
ÖÖE F
throw
ÖÖG L
new
ÖÖM P
ArgumentException
ÖÖQ b
(
ÖÖb c
$strÖÖc ´
,ÖÖ´ µ
$strÖÖ¶ Ã
)ÖÖÃ Ä
;ÖÖÄ Å

SqlCommand
ÙÙ 
cmd
ÙÙ 
=
ÙÙ 
new
ÙÙ  

SqlCommand
ÙÙ! +
(
ÙÙ+ ,
)
ÙÙ, -
;
ÙÙ- .
bool
ÚÚ !
mustCloseConnection
ÚÚ $
=
ÚÚ% &
false
ÚÚ' ,
;
ÚÚ, -
PrepareCommand
ÛÛ 
(
ÛÛ 
cmd
ÛÛ 
,
ÛÛ 
transaction
ÛÛ  +
.
ÛÛ+ ,

Connection
ÛÛ, 6
,
ÛÛ6 7
transaction
ÛÛ8 C
,
ÛÛC D
commandType
ÛÛE P
,
ÛÛP Q
commandText
ÛÛR ]
,
ÛÛ] ^
commandParameters
ÛÛ_ p
,
ÛÛp q
out
ÛÛr u"
mustCloseConnectionÛÛv ‰
)ÛÛ‰ Š
;ÛÛŠ ‹
	XmlReader
ŞŞ 
retval
ŞŞ 
=
ŞŞ 
cmd
ŞŞ "
.
ŞŞ" #
ExecuteXmlReader
ŞŞ# 3
(
ŞŞ3 4
)
ŞŞ4 5
;
ŞŞ5 6
cmd
áá 
.
áá 

Parameters
áá 
.
áá 
Clear
áá  
(
áá  !
)
áá! "
;
áá" #
return
ââ 
retval
ââ 
;
ââ 
}
ãã 	
public
ôô 
static
ôô 
	XmlReader
ôô 
ExecuteXmlReader
ôô  0
(
ôô0 1
SqlTransaction
ôô1 ?
transaction
ôô@ K
,
ôôK L
string
ôôM S
spName
ôôT Z
,
ôôZ [
params
ôô\ b
object
ôôc i
[
ôôi j
]
ôôj k
parameterValues
ôôl {
)
ôô{ |
{
õõ 	
if
öö 
(
öö 
transaction
öö 
==
öö 
null
öö #
)
öö# $
throw
öö% *
new
öö+ .#
ArgumentNullException
öö/ D
(
ööD E
$str
ööE R
)
ööR S
;
ööS T
if
÷÷ 
(
÷÷ 
transaction
÷÷ 
!=
÷÷ 
null
÷÷ #
&&
÷÷$ &
transaction
÷÷' 2
.
÷÷2 3

Connection
÷÷3 =
==
÷÷> @
null
÷÷A E
)
÷÷E F
throw
÷÷G L
new
÷÷M P
ArgumentException
÷÷Q b
(
÷÷b c
$str÷÷c ´
,÷÷´ µ
$str÷÷¶ Ã
)÷÷Ã Ä
;÷÷Ä Å
if
øø 
(
øø 
spName
øø 
==
øø 
null
øø 
||
øø !
spName
øø" (
.
øø( )
Length
øø) /
==
øø0 2
$num
øø3 4
)
øø4 5
throw
øø6 ;
new
øø< ?#
ArgumentNullException
øø@ U
(
øøU V
$str
øøV ^
)
øø^ _
;
øø_ `
if
ûû 
(
ûû 
(
ûû 
parameterValues
ûû  
!=
ûû! #
null
ûû$ (
)
ûû( )
&&
ûû* ,
(
ûû- .
parameterValues
ûû. =
.
ûû= >
Length
ûû> D
>
ûûE F
$num
ûûG H
)
ûûH I
)
ûûI J
{
üü 
SqlParameter
şş 
[
şş 
]
şş 
commandParameters
şş 0
=
şş1 2%
SqlHelperParameterCache
şş3 J
.
şşJ K
GetSpParameterSet
şşK \
(
şş\ ]
transaction
şş] h
.
şşh i

Connection
şşi s
,
şşs t
spName
şşu {
)
şş{ |
;
şş| }#
AssignParameterValues
 %
(
% &
commandParameters
& 7
,
7 8
parameterValues
9 H
)
H I
;
I J
return
„„ 
ExecuteXmlReader
„„ '
(
„„' (
transaction
„„( 3
,
„„3 4
CommandType
„„5 @
.
„„@ A
StoredProcedure
„„A P
,
„„P Q
spName
„„R X
,
„„X Y
commandParameters
„„Z k
)
„„k l
;
„„l m
}
…… 
else
†† 
{
‡‡ 
return
‰‰ 
ExecuteXmlReader
‰‰ '
(
‰‰' (
transaction
‰‰( 3
,
‰‰3 4
CommandType
‰‰5 @
.
‰‰@ A
StoredProcedure
‰‰A P
,
‰‰P Q
spName
‰‰R X
)
‰‰X Y
;
‰‰Y Z
}
ŠŠ 
}
‹‹ 	
public
 
static
 
void
 
FillDataset
 &
(
& '
string
' -
connectionString
. >
,
> ?
CommandType
@ K
commandType
L W
,
W X
string
Y _
commandText
` k
,
k l
DataSet
m t
dataSet
u |
,
| }
string~ „
[„ …
]… †

tableNames‡ ‘
)‘ ’
{
ŸŸ 	
if
   
(
   
connectionString
    
==
  ! #
null
  $ (
||
  ) +
connectionString
  , <
.
  < =
Length
  = C
==
  D F
$num
  G H
)
  H I
throw
  J O
new
  P S#
ArgumentNullException
  T i
(
  i j
$str
  j |
)
  | }
;
  } ~
if
¡¡ 
(
¡¡ 
dataSet
¡¡ 
==
¡¡ 
null
¡¡ 
)
¡¡  
throw
¡¡! &
new
¡¡' *#
ArgumentNullException
¡¡+ @
(
¡¡@ A
$str
¡¡A J
)
¡¡J K
;
¡¡K L
using
¤¤ 
(
¤¤ 
SqlConnection
¤¤  

connection
¤¤! +
=
¤¤, -
new
¤¤. 1
SqlConnection
¤¤2 ?
(
¤¤? @
connectionString
¤¤@ P
)
¤¤P Q
)
¤¤Q R
{
¥¥ 

connection
¦¦ 
.
¦¦ 
Open
¦¦ 
(
¦¦  
)
¦¦  !
;
¦¦! "
FillDataset
©© 
(
©© 

connection
©© &
,
©©& '
commandType
©©( 3
,
©©3 4
commandText
©©5 @
,
©©@ A
dataSet
©©B I
,
©©I J

tableNames
©©K U
)
©©U V
;
©©V W
}
ªª 
}
«« 	
public
½½ 
static
½½ 
void
½½ 
FillDataset
½½ &
(
½½& '
string
½½' -
connectionString
½½. >
,
½½> ?
CommandType
½½@ K
commandType
½½L W
,
½½W X
string
¾¾ 
commandText
¾¾ 
,
¾¾ 
DataSet
¾¾  '
dataSet
¾¾( /
,
¾¾/ 0
string
¾¾1 7
[
¾¾7 8
]
¾¾8 9

tableNames
¾¾: D
,
¾¾D E
params
¿¿ 
SqlParameter
¿¿ 
[
¿¿  
]
¿¿  !
commandParameters
¿¿" 3
)
¿¿3 4
{
ÀÀ 	
if
ÁÁ 
(
ÁÁ 
connectionString
ÁÁ  
==
ÁÁ! #
null
ÁÁ$ (
||
ÁÁ) +
connectionString
ÁÁ, <
.
ÁÁ< =
Length
ÁÁ= C
==
ÁÁD F
$num
ÁÁG H
)
ÁÁH I
throw
ÁÁJ O
new
ÁÁP S#
ArgumentNullException
ÁÁT i
(
ÁÁi j
$str
ÁÁj |
)
ÁÁ| }
;
ÁÁ} ~
if
ÂÂ 
(
ÂÂ 
dataSet
ÂÂ 
==
ÂÂ 
null
ÂÂ 
)
ÂÂ  
throw
ÂÂ! &
new
ÂÂ' *#
ArgumentNullException
ÂÂ+ @
(
ÂÂ@ A
$str
ÂÂA J
)
ÂÂJ K
;
ÂÂK L
using
ÄÄ 
(
ÄÄ 
SqlConnection
ÄÄ  

connection
ÄÄ! +
=
ÄÄ, -
new
ÄÄ. 1
SqlConnection
ÄÄ2 ?
(
ÄÄ? @
connectionString
ÄÄ@ P
)
ÄÄP Q
)
ÄÄQ R
{
ÅÅ 

connection
ÆÆ 
.
ÆÆ 
Open
ÆÆ 
(
ÆÆ  
)
ÆÆ  !
;
ÆÆ! "
FillDataset
ÉÉ 
(
ÉÉ 

connection
ÉÉ &
,
ÉÉ& '
commandType
ÉÉ( 3
,
ÉÉ3 4
commandText
ÉÉ5 @
,
ÉÉ@ A
dataSet
ÉÉB I
,
ÉÉI J

tableNames
ÉÉK U
,
ÉÉU V
commandParameters
ÉÉW h
)
ÉÉh i
;
ÉÉi j
}
ÊÊ 
}
ËË 	
public
ßß 
static
ßß 
void
ßß 
FillDataset
ßß &
(
ßß& '
string
ßß' -
connectionString
ßß. >
,
ßß> ?
string
ßß@ F
spName
ßßG M
,
ßßM N
DataSet
àà 
dataSet
àà 
,
àà 
string
àà #
[
àà# $
]
àà$ %

tableNames
àà& 0
,
àà0 1
params
áá 
object
áá 
[
áá 
]
áá 
parameterValues
áá +
)
áá+ ,
{
ââ 	
if
ãã 
(
ãã 
connectionString
ãã  
==
ãã! #
null
ãã$ (
||
ãã) +
connectionString
ãã, <
.
ãã< =
Length
ãã= C
==
ããD F
$num
ããG H
)
ããH I
throw
ããJ O
new
ããP S#
ArgumentNullException
ããT i
(
ããi j
$str
ããj |
)
ãã| }
;
ãã} ~
if
ää 
(
ää 
dataSet
ää 
==
ää 
null
ää 
)
ää  
throw
ää! &
new
ää' *#
ArgumentNullException
ää+ @
(
ää@ A
$str
ääA J
)
ääJ K
;
ääK L
using
ææ 
(
ææ 
SqlConnection
ææ  

connection
ææ! +
=
ææ, -
new
ææ. 1
SqlConnection
ææ2 ?
(
ææ? @
connectionString
ææ@ P
)
ææP Q
)
ææQ R
{
çç 

connection
èè 
.
èè 
Open
èè 
(
èè  
)
èè  !
;
èè! "
FillDataset
ëë 
(
ëë 

connection
ëë &
,
ëë& '
spName
ëë( .
,
ëë. /
dataSet
ëë0 7
,
ëë7 8

tableNames
ëë9 C
,
ëëC D
parameterValues
ëëE T
)
ëëT U
;
ëëU V
}
ìì 
}
íí 	
public
ıı 
static
ıı 
void
ıı 
FillDataset
ıı &
(
ıı& '
SqlConnection
ıı' 4

connection
ıı5 ?
,
ıı? @
CommandType
ııA L
commandType
ııM X
,
ııX Y
string
şş 
commandText
şş 
,
şş 
DataSet
şş  '
dataSet
şş( /
,
şş/ 0
string
şş1 7
[
şş7 8
]
şş8 9

tableNames
şş: D
)
şşD E
{
ÿÿ 	
FillDataset
€€ 
(
€€ 

connection
€€ "
,
€€" #
commandType
€€$ /
,
€€/ 0
commandText
€€1 <
,
€€< =
dataSet
€€> E
,
€€E F

tableNames
€€G Q
,
€€Q R
null
€€S W
)
€€W X
;
€€X Y
}
 	
public
““ 
static
““ 
void
““ 
FillDataset
““ &
(
““& '
SqlConnection
““' 4

connection
““5 ?
,
““? @
CommandType
““A L
commandType
““M X
,
““X Y
string
”” 
commandText
”” 
,
”” 
DataSet
””  '
dataSet
””( /
,
””/ 0
string
””1 7
[
””7 8
]
””8 9

tableNames
””: D
,
””D E
params
•• 
SqlParameter
•• 
[
••  
]
••  !
commandParameters
••" 3
)
••3 4
{
–– 	
FillDataset
—— 
(
—— 

connection
—— "
,
——" #
null
——$ (
,
——( )
commandType
——* 5
,
——5 6
commandText
——7 B
,
——B C
dataSet
——D K
,
——K L

tableNames
——M W
,
——W X
commandParameters
——Y j
)
——j k
;
——k l
}
˜˜ 	
public
¬¬ 
static
¬¬ 
void
¬¬ 
FillDataset
¬¬ &
(
¬¬& '
SqlConnection
¬¬' 4

connection
¬¬5 ?
,
¬¬? @
string
¬¬A G
spName
¬¬H N
,
¬¬N O
DataSet
­­ 
dataSet
­­ 
,
­­ 
string
­­ #
[
­­# $
]
­­$ %

tableNames
­­& 0
,
­­0 1
params
®® 
object
®® 
[
®® 
]
®® 
parameterValues
®® +
)
®®+ ,
{
¯¯ 	
if
°° 
(
°° 

connection
°° 
==
°° 
null
°° "
)
°°" #
throw
°°$ )
new
°°* -#
ArgumentNullException
°°. C
(
°°C D
$str
°°D P
)
°°P Q
;
°°Q R
if
±± 
(
±± 
dataSet
±± 
==
±± 
null
±± 
)
±±  
throw
±±! &
new
±±' *#
ArgumentNullException
±±+ @
(
±±@ A
$str
±±A J
)
±±J K
;
±±K L
if
²² 
(
²² 
spName
²² 
==
²² 
null
²² 
||
²² !
spName
²²" (
.
²²( )
Length
²²) /
==
²²0 2
$num
²²3 4
)
²²4 5
throw
²²6 ;
new
²²< ?#
ArgumentNullException
²²@ U
(
²²U V
$str
²²V ^
)
²²^ _
;
²²_ `
if
µµ 
(
µµ 
(
µµ 
parameterValues
µµ  
!=
µµ! #
null
µµ$ (
)
µµ( )
&&
µµ* ,
(
µµ- .
parameterValues
µµ. =
.
µµ= >
Length
µµ> D
>
µµE F
$num
µµG H
)
µµH I
)
µµI J
{
¶¶ 
SqlParameter
¸¸ 
[
¸¸ 
]
¸¸ 
commandParameters
¸¸ 0
=
¸¸1 2%
SqlHelperParameterCache
¸¸3 J
.
¸¸J K
GetSpParameterSet
¸¸K \
(
¸¸\ ]

connection
¸¸] g
,
¸¸g h
spName
¸¸i o
)
¸¸o p
;
¸¸p q#
AssignParameterValues
»» %
(
»»% &
commandParameters
»»& 7
,
»»7 8
parameterValues
»»9 H
)
»»H I
;
»»I J
FillDataset
¾¾ 
(
¾¾ 

connection
¾¾ &
,
¾¾& '
CommandType
¾¾( 3
.
¾¾3 4
StoredProcedure
¾¾4 C
,
¾¾C D
spName
¾¾E K
,
¾¾K L
dataSet
¾¾M T
,
¾¾T U

tableNames
¾¾V `
,
¾¾` a
commandParameters
¾¾b s
)
¾¾s t
;
¾¾t u
}
¿¿ 
else
ÀÀ 
{
ÁÁ 
FillDataset
ÃÃ 
(
ÃÃ 

connection
ÃÃ &
,
ÃÃ& '
CommandType
ÃÃ( 3
.
ÃÃ3 4
StoredProcedure
ÃÃ4 C
,
ÃÃC D
spName
ÃÃE K
,
ÃÃK L
dataSet
ÃÃM T
,
ÃÃT U

tableNames
ÃÃV `
)
ÃÃ` a
;
ÃÃa b
}
ÄÄ 
}
ÅÅ 	
public
ÕÕ 
static
ÕÕ 
void
ÕÕ 
FillDataset
ÕÕ &
(
ÕÕ& '
SqlTransaction
ÕÕ' 5
transaction
ÕÕ6 A
,
ÕÕA B
CommandType
ÕÕC N
commandType
ÕÕO Z
,
ÕÕZ [
string
ÖÖ 
commandText
ÖÖ 
,
ÖÖ 
DataSet
×× 
dataSet
×× 
,
×× 
string
×× #
[
××# $
]
××$ %

tableNames
××& 0
)
××0 1
{
ØØ 	
FillDataset
ÙÙ 
(
ÙÙ 
transaction
ÙÙ #
,
ÙÙ# $
commandType
ÙÙ% 0
,
ÙÙ0 1
commandText
ÙÙ2 =
,
ÙÙ= >
dataSet
ÙÙ? F
,
ÙÙF G

tableNames
ÙÙH R
,
ÙÙR S
null
ÙÙT X
)
ÙÙX Y
;
ÙÙY Z
}
ÚÚ 	
public
ìì 
static
ìì 
void
ìì 
FillDataset
ìì &
(
ìì& '
SqlTransaction
ìì' 5
transaction
ìì6 A
,
ììA B
CommandType
ììC N
commandType
ììO Z
,
ììZ [
string
íí 
commandText
íí 
,
íí 
DataSet
íí  '
dataSet
íí( /
,
íí/ 0
string
íí1 7
[
íí7 8
]
íí8 9

tableNames
íí: D
,
ííD E
params
îî 
SqlParameter
îî 
[
îî  
]
îî  !
commandParameters
îî" 3
)
îî3 4
{
ïï 	
FillDataset
ğğ 
(
ğğ 
transaction
ğğ #
.
ğğ# $

Connection
ğğ$ .
,
ğğ. /
transaction
ğğ0 ;
,
ğğ; <
commandType
ğğ= H
,
ğğH I
commandText
ğğJ U
,
ğğU V
dataSet
ğğW ^
,
ğğ^ _

tableNames
ğğ` j
,
ğğj k
commandParameters
ğğl }
)
ğğ} ~
;
ğğ~ 
}
ññ 	
public
…… 
static
…… 
void
…… 
FillDataset
…… &
(
……& '
SqlTransaction
……' 5
transaction
……6 A
,
……A B
string
……C I
spName
……J P
,
……P Q
DataSet
†† 
dataSet
†† 
,
†† 
string
†† #
[
††# $
]
††$ %

tableNames
††& 0
,
††0 1
params
‡‡ 
object
‡‡ 
[
‡‡ 
]
‡‡ 
parameterValues
‡‡ +
)
‡‡+ ,
{
ˆˆ 	
if
‰‰ 
(
‰‰ 
transaction
‰‰ 
==
‰‰ 
null
‰‰ #
)
‰‰# $
throw
‰‰% *
new
‰‰+ .#
ArgumentNullException
‰‰/ D
(
‰‰D E
$str
‰‰E R
)
‰‰R S
;
‰‰S T
if
ŠŠ 
(
ŠŠ 
transaction
ŠŠ 
!=
ŠŠ 
null
ŠŠ #
&&
ŠŠ$ &
transaction
ŠŠ' 2
.
ŠŠ2 3

Connection
ŠŠ3 =
==
ŠŠ> @
null
ŠŠA E
)
ŠŠE F
throw
ŠŠG L
new
ŠŠM P
ArgumentException
ŠŠQ b
(
ŠŠb c
$strŠŠc ´
,ŠŠ´ µ
$strŠŠ¶ Ã
)ŠŠÃ Ä
;ŠŠÄ Å
if
‹‹ 
(
‹‹ 
dataSet
‹‹ 
==
‹‹ 
null
‹‹ 
)
‹‹  
throw
‹‹! &
new
‹‹' *#
ArgumentNullException
‹‹+ @
(
‹‹@ A
$str
‹‹A J
)
‹‹J K
;
‹‹K L
if
ŒŒ 
(
ŒŒ 
spName
ŒŒ 
==
ŒŒ 
null
ŒŒ 
||
ŒŒ !
spName
ŒŒ" (
.
ŒŒ( )
Length
ŒŒ) /
==
ŒŒ0 2
$num
ŒŒ3 4
)
ŒŒ4 5
throw
ŒŒ6 ;
new
ŒŒ< ?#
ArgumentNullException
ŒŒ@ U
(
ŒŒU V
$str
ŒŒV ^
)
ŒŒ^ _
;
ŒŒ_ `
if
 
(
 
(
 
parameterValues
  
!=
! #
null
$ (
)
( )
&&
* ,
(
- .
parameterValues
. =
.
= >
Length
> D
>
E F
$num
G H
)
H I
)
I J
{
 
SqlParameter
’’ 
[
’’ 
]
’’ 
commandParameters
’’ 0
=
’’1 2%
SqlHelperParameterCache
’’3 J
.
’’J K
GetSpParameterSet
’’K \
(
’’\ ]
transaction
’’] h
.
’’h i

Connection
’’i s
,
’’s t
spName
’’u {
)
’’{ |
;
’’| }#
AssignParameterValues
•• %
(
••% &
commandParameters
••& 7
,
••7 8
parameterValues
••9 H
)
••H I
;
••I J
FillDataset
˜˜ 
(
˜˜ 
transaction
˜˜ '
,
˜˜' (
CommandType
˜˜) 4
.
˜˜4 5
StoredProcedure
˜˜5 D
,
˜˜D E
spName
˜˜F L
,
˜˜L M
dataSet
˜˜N U
,
˜˜U V

tableNames
˜˜W a
,
˜˜a b
commandParameters
˜˜c t
)
˜˜t u
;
˜˜u v
}
™™ 
else
šš 
{
›› 
FillDataset
 
(
 
transaction
 '
,
' (
CommandType
) 4
.
4 5
StoredProcedure
5 D
,
D E
spName
F L
,
L M
dataSet
N U
,
U V

tableNames
W a
)
a b
;
b c
}
 
}
ŸŸ 	
private
²² 
static
²² 
void
²² 
FillDataset
²² '
(
²²' (
SqlConnection
²²( 5

connection
²²6 @
,
²²@ A
SqlTransaction
²²B P
transaction
²²Q \
,
²²\ ]
CommandType
²²^ i
commandType
²²j u
,
²²u v
string
³³	 
commandText
³³ 
,
³³ 
DataSet
³³ $
dataSet
³³% ,
,
³³, -
string
³³. 4
[
³³4 5
]
³³5 6

tableNames
³³7 A
,
³³A B
params
´´	 
SqlParameter
´´ 
[
´´ 
]
´´ 
commandParameters
´´ 0
)
´´0 1
{
µµ 	
if
¶¶ 
(
¶¶ 

connection
¶¶ 
==
¶¶ 
null
¶¶ "
)
¶¶" #
throw
¶¶$ )
new
¶¶* -#
ArgumentNullException
¶¶. C
(
¶¶C D
$str
¶¶D P
)
¶¶P Q
;
¶¶Q R
if
·· 
(
·· 
dataSet
·· 
==
·· 
null
·· 
)
··  
throw
··! &
new
··' *#
ArgumentNullException
··+ @
(
··@ A
$str
··A J
)
··J K
;
··K L

SqlCommand
ºº 
command
ºº 
=
ºº  
new
ºº! $

SqlCommand
ºº% /
(
ºº/ 0
)
ºº0 1
;
ºº1 2
bool
»» !
mustCloseConnection
»» $
=
»»% &
false
»»' ,
;
»», -
PrepareCommand
¼¼ 
(
¼¼ 
command
¼¼ "
,
¼¼" #

connection
¼¼$ .
,
¼¼. /
transaction
¼¼0 ;
,
¼¼; <
commandType
¼¼= H
,
¼¼H I
commandText
¼¼J U
,
¼¼U V
commandParameters
¼¼W h
,
¼¼h i
out
¼¼j m"
mustCloseConnection¼¼n 
)¼¼ ‚
;¼¼‚ ƒ
using
¿¿ 
(
¿¿ 
SqlDataAdapter
¿¿ !
dataAdapter
¿¿" -
=
¿¿. /
new
¿¿0 3
SqlDataAdapter
¿¿4 B
(
¿¿B C
command
¿¿C J
)
¿¿J K
)
¿¿K L
{
ÀÀ 
if
ÃÃ 
(
ÃÃ 

tableNames
ÃÃ 
!=
ÃÃ !
null
ÃÃ" &
&&
ÃÃ' )

tableNames
ÃÃ* 4
.
ÃÃ4 5
Length
ÃÃ5 ;
>
ÃÃ< =
$num
ÃÃ> ?
)
ÃÃ? @
{
ÄÄ 
string
ÅÅ 
	tableName
ÅÅ $
=
ÅÅ% &
$str
ÅÅ' .
;
ÅÅ. /
for
ÆÆ 
(
ÆÆ 
int
ÆÆ 
index
ÆÆ "
=
ÆÆ# $
$num
ÆÆ% &
;
ÆÆ& '
index
ÆÆ( -
<
ÆÆ. /

tableNames
ÆÆ0 :
.
ÆÆ: ;
Length
ÆÆ; A
;
ÆÆA B
index
ÆÆC H
++
ÆÆH J
)
ÆÆJ K
{
ÇÇ 
if
ÈÈ 
(
ÈÈ 

tableNames
ÈÈ &
[
ÈÈ& '
index
ÈÈ' ,
]
ÈÈ, -
==
ÈÈ. 0
null
ÈÈ1 5
||
ÈÈ6 8

tableNames
ÈÈ9 C
[
ÈÈC D
index
ÈÈD I
]
ÈÈI J
.
ÈÈJ K
Length
ÈÈK Q
==
ÈÈR T
$num
ÈÈU V
)
ÈÈV W
throw
ÈÈX ]
new
ÈÈ^ a
ArgumentException
ÈÈb s
(
ÈÈs t
$strÈÈt Û
,ÈÈÛ Ü
$strÈÈİ é
)ÈÈé ê
;ÈÈê ë
dataAdapter
ÉÉ #
.
ÉÉ# $
TableMappings
ÉÉ$ 1
.
ÉÉ1 2
Add
ÉÉ2 5
(
ÉÉ5 6
	tableName
ÉÉ6 ?
,
ÉÉ? @

tableNames
ÉÉA K
[
ÉÉK L
index
ÉÉL Q
]
ÉÉQ R
)
ÉÉR S
;
ÉÉS T
	tableName
ÊÊ !
+=
ÊÊ" $
(
ÊÊ% &
index
ÊÊ& +
+
ÊÊ, -
$num
ÊÊ. /
)
ÊÊ/ 0
.
ÊÊ0 1
ToString
ÊÊ1 9
(
ÊÊ9 :
)
ÊÊ: ;
;
ÊÊ; <
}
ËË 
}
ÌÌ 
dataAdapter
ÏÏ 
.
ÏÏ 
Fill
ÏÏ  
(
ÏÏ  !
dataSet
ÏÏ! (
)
ÏÏ( )
;
ÏÏ) *
command
ÒÒ 
.
ÒÒ 

Parameters
ÒÒ "
.
ÒÒ" #
Clear
ÒÒ# (
(
ÒÒ( )
)
ÒÒ) *
;
ÒÒ* +
}
ÓÓ 
if
ÕÕ 
(
ÕÕ !
mustCloseConnection
ÕÕ #
)
ÕÕ# $

connection
ÖÖ 
.
ÖÖ 
Close
ÖÖ  
(
ÖÖ  !
)
ÖÖ! "
;
ÖÖ" #
}
×× 	
public
çç 
static
çç 
void
çç 
UpdateDataset
çç (
(
çç( )

SqlCommand
çç) 3
insertCommand
çç4 A
,
ççA B

SqlCommand
ççC M
deleteCommand
ççN [
,
çç[ \

SqlCommand
çç] g
updateCommand
ççh u
,
ççu v
DataSet
ççw ~
dataSetçç †
,çç† ‡
stringççˆ 
	tableNameçç ˜
)çç˜ ™
{
èè 	
if
éé 
(
éé 
insertCommand
éé 
==
éé  
null
éé! %
)
éé% &
throw
éé' ,
new
éé- 0#
ArgumentNullException
éé1 F
(
ééF G
$str
ééG V
)
ééV W
;
ééW X
if
êê 
(
êê 
deleteCommand
êê 
==
êê  
null
êê! %
)
êê% &
throw
êê' ,
new
êê- 0#
ArgumentNullException
êê1 F
(
êêF G
$str
êêG V
)
êêV W
;
êêW X
if
ëë 
(
ëë 
updateCommand
ëë 
==
ëë  
null
ëë! %
)
ëë% &
throw
ëë' ,
new
ëë- 0#
ArgumentNullException
ëë1 F
(
ëëF G
$str
ëëG V
)
ëëV W
;
ëëW X
if
ìì 
(
ìì 
	tableName
ìì 
==
ìì 
null
ìì !
||
ìì" $
	tableName
ìì% .
.
ìì. /
Length
ìì/ 5
==
ìì6 8
$num
ìì9 :
)
ìì: ;
throw
ìì< A
new
ììB E#
ArgumentNullException
ììF [
(
ìì[ \
$str
ìì\ g
)
ììg h
;
ììh i
using
ïï 
(
ïï 
SqlDataAdapter
ïï !
dataAdapter
ïï" -
=
ïï. /
new
ïï0 3
SqlDataAdapter
ïï4 B
(
ïïB C
)
ïïC D
)
ïïD E
{
ğğ 
dataAdapter
òò 
.
òò 
UpdateCommand
òò )
=
òò* +
updateCommand
òò, 9
;
òò9 :
dataAdapter
óó 
.
óó 
InsertCommand
óó )
=
óó* +
insertCommand
óó, 9
;
óó9 :
dataAdapter
ôô 
.
ôô 
DeleteCommand
ôô )
=
ôô* +
deleteCommand
ôô, 9
;
ôô9 :
dataAdapter
÷÷ 
.
÷÷ 
Update
÷÷ "
(
÷÷" #
dataSet
÷÷# *
,
÷÷* +
	tableName
÷÷, 5
)
÷÷5 6
;
÷÷6 7
dataSet
úú 
.
úú 
AcceptChanges
úú %
(
úú% &
)
úú& '
;
úú' (
}
ûû 
}
üü 	
public
ŒŒ 
static
ŒŒ 

SqlCommand
ŒŒ  
CreateCommand
ŒŒ! .
(
ŒŒ. /
SqlConnection
ŒŒ/ <

connection
ŒŒ= G
,
ŒŒG H
string
ŒŒI O
spName
ŒŒP V
,
ŒŒV W
params
ŒŒX ^
string
ŒŒ_ e
[
ŒŒe f
]
ŒŒf g
sourceColumns
ŒŒh u
)
ŒŒu v
{
 	
if
 
(
 

connection
 
==
 
null
 "
)
" #
throw
$ )
new
* -#
ArgumentNullException
. C
(
C D
$str
D P
)
P Q
;
Q R
if
 
(
 
spName
 
==
 
null
 
||
 !
spName
" (
.
( )
Length
) /
==
0 2
$num
3 4
)
4 5
throw
6 ;
new
< ?#
ArgumentNullException
@ U
(
U V
$str
V ^
)
^ _
;
_ `

SqlCommand
’’ 
cmd
’’ 
=
’’ 
new
’’  

SqlCommand
’’! +
(
’’+ ,
spName
’’, 2
,
’’2 3

connection
’’4 >
)
’’> ?
;
’’? @
cmd
““ 
.
““ 
CommandType
““ 
=
““ 
CommandType
““ )
.
““) *
StoredProcedure
““* 9
;
““9 :
if
–– 
(
–– 
(
–– 
sourceColumns
–– 
!=
–– !
null
––" &
)
––& '
&&
––( *
(
––+ ,
sourceColumns
––, 9
.
––9 :
Length
––: @
>
––A B
$num
––C D
)
––D E
)
––E F
{
—— 
SqlParameter
™™ 
[
™™ 
]
™™ 
commandParameters
™™ 0
=
™™1 2%
SqlHelperParameterCache
™™3 J
.
™™J K
GetSpParameterSet
™™K \
(
™™\ ]

connection
™™] g
,
™™g h
spName
™™i o
)
™™o p
;
™™p q
for
œœ 
(
œœ 
int
œœ 
index
œœ 
=
œœ  
$num
œœ! "
;
œœ" #
index
œœ$ )
<
œœ* +
sourceColumns
œœ, 9
.
œœ9 :
Length
œœ: @
;
œœ@ A
index
œœB G
++
œœG I
)
œœI J
commandParameters
 %
[
% &
index
& +
]
+ ,
.
, -
SourceColumn
- 9
=
: ;
sourceColumns
< I
[
I J
index
J O
]
O P
;
P Q
AttachParameters
    
(
    !
cmd
  ! $
,
  $ %
commandParameters
  & 7
)
  7 8
;
  8 9
}
¡¡ 
return
££ 
cmd
££ 
;
££ 
}
¤¤ 	
public
²² 
static
²² 
int
²² (
ExecuteNonQueryTypedParams
²² 4
(
²²4 5
String
²²5 ;
connectionString
²²< L
,
²²L M
String
²²N T
spName
²²U [
,
²²[ \
DataRow
²²] d
dataRow
²²e l
)
²²l m
{
³³ 	
if
´´ 
(
´´ 
connectionString
´´  
==
´´! #
null
´´$ (
||
´´) +
connectionString
´´, <
.
´´< =
Length
´´= C
==
´´D F
$num
´´G H
)
´´H I
throw
´´J O
new
´´P S#
ArgumentNullException
´´T i
(
´´i j
$str
´´j |
)
´´| }
;
´´} ~
if
µµ 
(
µµ 
spName
µµ 
==
µµ 
null
µµ 
||
µµ !
spName
µµ" (
.
µµ( )
Length
µµ) /
==
µµ0 2
$num
µµ3 4
)
µµ4 5
throw
µµ6 ;
new
µµ< ?#
ArgumentNullException
µµ@ U
(
µµU V
$str
µµV ^
)
µµ^ _
;
µµ_ `
if
¸¸ 
(
¸¸ 
dataRow
¸¸ 
!=
¸¸ 
null
¸¸ 
&&
¸¸  "
dataRow
¸¸# *
.
¸¸* +
	ItemArray
¸¸+ 4
.
¸¸4 5
Length
¸¸5 ;
>
¸¸< =
$num
¸¸> ?
)
¸¸? @
{
¹¹ 
SqlParameter
»» 
[
»» 
]
»» 
commandParameters
»» 0
=
»»1 2%
SqlHelperParameterCache
»»3 J
.
»»J K
GetSpParameterSet
»»K \
(
»»\ ]
connectionString
»»] m
,
»»m n
spName
»»o u
)
»»u v
;
»»v w#
AssignParameterValues
¾¾ %
(
¾¾% &
commandParameters
¾¾& 7
,
¾¾7 8
dataRow
¾¾9 @
)
¾¾@ A
;
¾¾A B
return
ÀÀ 
	SqlHelper
ÀÀ  
.
ÀÀ  !
ExecuteNonQuery
ÀÀ! 0
(
ÀÀ0 1
connectionString
ÀÀ1 A
,
ÀÀA B
CommandType
ÀÀC N
.
ÀÀN O
StoredProcedure
ÀÀO ^
,
ÀÀ^ _
spName
ÀÀ` f
,
ÀÀf g
commandParameters
ÀÀh y
)
ÀÀy z
;
ÀÀz {
}
ÁÁ 
else
ÂÂ 
{
ÃÃ 
return
ÄÄ 
	SqlHelper
ÄÄ  
.
ÄÄ  !
ExecuteNonQuery
ÄÄ! 0
(
ÄÄ0 1
connectionString
ÄÄ1 A
,
ÄÄA B
CommandType
ÄÄC N
.
ÄÄN O
StoredProcedure
ÄÄO ^
,
ÄÄ^ _
spName
ÄÄ` f
)
ÄÄf g
;
ÄÄg h
}
ÅÅ 
}
ÆÆ 	
public
ÒÒ 
static
ÒÒ 
int
ÒÒ (
ExecuteNonQueryTypedParams
ÒÒ 4
(
ÒÒ4 5
SqlConnection
ÒÒ5 B

connection
ÒÒC M
,
ÒÒM N
String
ÒÒO U
spName
ÒÒV \
,
ÒÒ\ ]
DataRow
ÒÒ^ e
dataRow
ÒÒf m
)
ÒÒm n
{
ÓÓ 	
if
ÔÔ 
(
ÔÔ 

connection
ÔÔ 
==
ÔÔ 
null
ÔÔ "
)
ÔÔ" #
throw
ÔÔ$ )
new
ÔÔ* -#
ArgumentNullException
ÔÔ. C
(
ÔÔC D
$str
ÔÔD P
)
ÔÔP Q
;
ÔÔQ R
if
ÕÕ 
(
ÕÕ 
spName
ÕÕ 
==
ÕÕ 
null
ÕÕ 
||
ÕÕ !
spName
ÕÕ" (
.
ÕÕ( )
Length
ÕÕ) /
==
ÕÕ0 2
$num
ÕÕ3 4
)
ÕÕ4 5
throw
ÕÕ6 ;
new
ÕÕ< ?#
ArgumentNullException
ÕÕ@ U
(
ÕÕU V
$str
ÕÕV ^
)
ÕÕ^ _
;
ÕÕ_ `
if
ØØ 
(
ØØ 
dataRow
ØØ 
!=
ØØ 
null
ØØ 
&&
ØØ  "
dataRow
ØØ# *
.
ØØ* +
	ItemArray
ØØ+ 4
.
ØØ4 5
Length
ØØ5 ;
>
ØØ< =
$num
ØØ> ?
)
ØØ? @
{
ÙÙ 
SqlParameter
ÛÛ 
[
ÛÛ 
]
ÛÛ 
commandParameters
ÛÛ 0
=
ÛÛ1 2%
SqlHelperParameterCache
ÛÛ3 J
.
ÛÛJ K
GetSpParameterSet
ÛÛK \
(
ÛÛ\ ]

connection
ÛÛ] g
,
ÛÛg h
spName
ÛÛi o
)
ÛÛo p
;
ÛÛp q#
AssignParameterValues
ŞŞ %
(
ŞŞ% &
commandParameters
ŞŞ& 7
,
ŞŞ7 8
dataRow
ŞŞ9 @
)
ŞŞ@ A
;
ŞŞA B
return
àà 
	SqlHelper
àà  
.
àà  !
ExecuteNonQuery
àà! 0
(
àà0 1

connection
àà1 ;
,
àà; <
CommandType
àà= H
.
ààH I
StoredProcedure
ààI X
,
ààX Y
spName
ààZ `
,
àà` a
commandParameters
ààb s
)
ààs t
;
ààt u
}
áá 
else
ââ 
{
ãã 
return
ää 
	SqlHelper
ää  
.
ää  !
ExecuteNonQuery
ää! 0
(
ää0 1

connection
ää1 ;
,
ää; <
CommandType
ää= H
.
ääH I
StoredProcedure
ääI X
,
ääX Y
spName
ääZ `
)
ää` a
;
ääa b
}
åå 
}
ææ 	
public
òò 
static
òò 
int
òò (
ExecuteNonQueryTypedParams
òò 4
(
òò4 5
SqlTransaction
òò5 C
transaction
òòD O
,
òòO P
String
òòQ W
spName
òòX ^
,
òò^ _
DataRow
òò` g
dataRow
òòh o
)
òòo p
{
óó 	
if
ôô 
(
ôô 
transaction
ôô 
==
ôô 
null
ôô #
)
ôô# $
throw
ôô% *
new
ôô+ .#
ArgumentNullException
ôô/ D
(
ôôD E
$str
ôôE R
)
ôôR S
;
ôôS T
if
õõ 
(
õõ 
transaction
õõ 
!=
õõ 
null
õõ #
&&
õõ$ &
transaction
õõ' 2
.
õõ2 3

Connection
õõ3 =
==
õõ> @
null
õõA E
)
õõE F
throw
õõG L
new
õõM P
ArgumentException
õõQ b
(
õõb c
$strõõc ´
,õõ´ µ
$strõõ¶ Ã
)õõÃ Ä
;õõÄ Å
if
öö 
(
öö 
spName
öö 
==
öö 
null
öö 
||
öö !
spName
öö" (
.
öö( )
Length
öö) /
==
öö0 2
$num
öö3 4
)
öö4 5
throw
öö6 ;
new
öö< ?#
ArgumentNullException
öö@ U
(
ööU V
$str
ööV ^
)
öö^ _
;
öö_ `
if
ùù 
(
ùù 
dataRow
ùù 
!=
ùù 
null
ùù 
&&
ùù  "
dataRow
ùù# *
.
ùù* +
	ItemArray
ùù+ 4
.
ùù4 5
Length
ùù5 ;
>
ùù< =
$num
ùù> ?
)
ùù? @
{
úú 
SqlParameter
üü 
[
üü 
]
üü 
commandParameters
üü 0
=
üü1 2%
SqlHelperParameterCache
üü3 J
.
üüJ K
GetSpParameterSet
üüK \
(
üü\ ]
transaction
üü] h
.
üüh i

Connection
üüi s
,
üüs t
spName
üüu {
)
üü{ |
;
üü| }#
AssignParameterValues
ÿÿ %
(
ÿÿ% &
commandParameters
ÿÿ& 7
,
ÿÿ7 8
dataRow
ÿÿ9 @
)
ÿÿ@ A
;
ÿÿA B
return
 
	SqlHelper
  
.
  !
ExecuteNonQuery
! 0
(
0 1
transaction
1 <
,
< =
CommandType
> I
.
I J
StoredProcedure
J Y
,
Y Z
spName
[ a
,
a b
commandParameters
c t
)
t u
;
u v
}
‚‚ 
else
ƒƒ 
{
„„ 
return
…… 
	SqlHelper
……  
.
……  !
ExecuteNonQuery
……! 0
(
……0 1
transaction
……1 <
,
……< =
CommandType
……> I
.
……I J
StoredProcedure
……J Y
,
……Y Z
spName
……[ a
)
……a b
;
……b c
}
†† 
}
‡‡ 	
public
•• 
static
•• 
DataSet
•• '
ExecuteDatasetTypedParams
•• 7
(
••7 8
string
••8 >
connectionString
••? O
,
••O P
String
••Q W
spName
••X ^
,
••^ _
DataRow
••` g
dataRow
••h o
)
••o p
{
–– 	
if
—— 
(
—— 
connectionString
——  
==
——! #
null
——$ (
||
——) +
connectionString
——, <
.
——< =
Length
——= C
==
——D F
$num
——G H
)
——H I
throw
——J O
new
——P S#
ArgumentNullException
——T i
(
——i j
$str
——j |
)
——| }
;
——} ~
if
˜˜ 
(
˜˜ 
spName
˜˜ 
==
˜˜ 
null
˜˜ 
||
˜˜ !
spName
˜˜" (
.
˜˜( )
Length
˜˜) /
==
˜˜0 2
$num
˜˜3 4
)
˜˜4 5
throw
˜˜6 ;
new
˜˜< ?#
ArgumentNullException
˜˜@ U
(
˜˜U V
$str
˜˜V ^
)
˜˜^ _
;
˜˜_ `
if
›› 
(
›› 
dataRow
›› 
!=
›› 
null
›› 
&&
››  "
dataRow
››# *
.
››* +
	ItemArray
››+ 4
.
››4 5
Length
››5 ;
>
››< =
$num
››> ?
)
››? @
{
œœ 
SqlParameter
 
[
 
]
 
commandParameters
 0
=
1 2%
SqlHelperParameterCache
3 J
.
J K
GetSpParameterSet
K \
(
\ ]
connectionString
] m
,
m n
spName
o u
)
u v
;
v w#
AssignParameterValues
¡¡ %
(
¡¡% &
commandParameters
¡¡& 7
,
¡¡7 8
dataRow
¡¡9 @
)
¡¡@ A
;
¡¡A B
return
££ 
	SqlHelper
££  
.
££  !
ExecuteDataset
££! /
(
££/ 0
connectionString
££0 @
,
££@ A
CommandType
££B M
.
££M N
StoredProcedure
££N ]
,
££] ^
spName
££_ e
,
££e f
commandParameters
££g x
)
££x y
;
££y z
}
¤¤ 
else
¥¥ 
{
¦¦ 
return
§§ 
	SqlHelper
§§  
.
§§  !
ExecuteDataset
§§! /
(
§§/ 0
connectionString
§§0 @
,
§§@ A
CommandType
§§B M
.
§§M N
StoredProcedure
§§N ]
,
§§] ^
spName
§§_ e
)
§§e f
;
§§f g
}
¨¨ 
}
©© 	
public
µµ 
static
µµ 
DataSet
µµ '
ExecuteDatasetTypedParams
µµ 7
(
µµ7 8
SqlConnection
µµ8 E

connection
µµF P
,
µµP Q
String
µµR X
spName
µµY _
,
µµ_ `
DataRow
µµa h
dataRow
µµi p
)
µµp q
{
¶¶ 	
if
·· 
(
·· 

connection
·· 
==
·· 
null
·· "
)
··" #
throw
··$ )
new
··* -#
ArgumentNullException
··. C
(
··C D
$str
··D P
)
··P Q
;
··Q R
if
¸¸ 
(
¸¸ 
spName
¸¸ 
==
¸¸ 
null
¸¸ 
||
¸¸ !
spName
¸¸" (
.
¸¸( )
Length
¸¸) /
==
¸¸0 2
$num
¸¸3 4
)
¸¸4 5
throw
¸¸6 ;
new
¸¸< ?#
ArgumentNullException
¸¸@ U
(
¸¸U V
$str
¸¸V ^
)
¸¸^ _
;
¸¸_ `
if
»» 
(
»» 
dataRow
»» 
!=
»» 
null
»» 
&&
»»  "
dataRow
»»# *
.
»»* +
	ItemArray
»»+ 4
.
»»4 5
Length
»»5 ;
>
»»< =
$num
»»> ?
)
»»? @
{
¼¼ 
SqlParameter
¾¾ 
[
¾¾ 
]
¾¾ 
commandParameters
¾¾ 0
=
¾¾1 2%
SqlHelperParameterCache
¾¾3 J
.
¾¾J K
GetSpParameterSet
¾¾K \
(
¾¾\ ]

connection
¾¾] g
,
¾¾g h
spName
¾¾i o
)
¾¾o p
;
¾¾p q#
AssignParameterValues
ÁÁ %
(
ÁÁ% &
commandParameters
ÁÁ& 7
,
ÁÁ7 8
dataRow
ÁÁ9 @
)
ÁÁ@ A
;
ÁÁA B
return
ÃÃ 
	SqlHelper
ÃÃ  
.
ÃÃ  !
ExecuteDataset
ÃÃ! /
(
ÃÃ/ 0

connection
ÃÃ0 :
,
ÃÃ: ;
CommandType
ÃÃ< G
.
ÃÃG H
StoredProcedure
ÃÃH W
,
ÃÃW X
spName
ÃÃY _
,
ÃÃ_ `
commandParameters
ÃÃa r
)
ÃÃr s
;
ÃÃs t
}
ÄÄ 
else
ÅÅ 
{
ÆÆ 
return
ÇÇ 
	SqlHelper
ÇÇ  
.
ÇÇ  !
ExecuteDataset
ÇÇ! /
(
ÇÇ/ 0

connection
ÇÇ0 :
,
ÇÇ: ;
CommandType
ÇÇ< G
.
ÇÇG H
StoredProcedure
ÇÇH W
,
ÇÇW X
spName
ÇÇY _
)
ÇÇ_ `
;
ÇÇ` a
}
ÈÈ 
}
ÉÉ 	
public
ÕÕ 
static
ÕÕ 
DataSet
ÕÕ '
ExecuteDatasetTypedParams
ÕÕ 7
(
ÕÕ7 8
SqlTransaction
ÕÕ8 F
transaction
ÕÕG R
,
ÕÕR S
String
ÕÕT Z
spName
ÕÕ[ a
,
ÕÕa b
DataRow
ÕÕc j
dataRow
ÕÕk r
)
ÕÕr s
{
ÖÖ 	
if
×× 
(
×× 
transaction
×× 
==
×× 
null
×× #
)
××# $
throw
××% *
new
××+ .#
ArgumentNullException
××/ D
(
××D E
$str
××E R
)
××R S
;
××S T
if
ØØ 
(
ØØ 
transaction
ØØ 
!=
ØØ 
null
ØØ #
&&
ØØ$ &
transaction
ØØ' 2
.
ØØ2 3

Connection
ØØ3 =
==
ØØ> @
null
ØØA E
)
ØØE F
throw
ØØG L
new
ØØM P
ArgumentException
ØØQ b
(
ØØb c
$strØØc ´
,ØØ´ µ
$strØØ¶ Ã
)ØØÃ Ä
;ØØÄ Å
if
ÙÙ 
(
ÙÙ 
spName
ÙÙ 
==
ÙÙ 
null
ÙÙ 
||
ÙÙ !
spName
ÙÙ" (
.
ÙÙ( )
Length
ÙÙ) /
==
ÙÙ0 2
$num
ÙÙ3 4
)
ÙÙ4 5
throw
ÙÙ6 ;
new
ÙÙ< ?#
ArgumentNullException
ÙÙ@ U
(
ÙÙU V
$str
ÙÙV ^
)
ÙÙ^ _
;
ÙÙ_ `
if
ÜÜ 
(
ÜÜ 
dataRow
ÜÜ 
!=
ÜÜ 
null
ÜÜ 
&&
ÜÜ  "
dataRow
ÜÜ# *
.
ÜÜ* +
	ItemArray
ÜÜ+ 4
.
ÜÜ4 5
Length
ÜÜ5 ;
>
ÜÜ< =
$num
ÜÜ> ?
)
ÜÜ? @
{
İİ 
SqlParameter
ßß 
[
ßß 
]
ßß 
commandParameters
ßß 0
=
ßß1 2%
SqlHelperParameterCache
ßß3 J
.
ßßJ K
GetSpParameterSet
ßßK \
(
ßß\ ]
transaction
ßß] h
.
ßßh i

Connection
ßßi s
,
ßßs t
spName
ßßu {
)
ßß{ |
;
ßß| }#
AssignParameterValues
ââ %
(
ââ% &
commandParameters
ââ& 7
,
ââ7 8
dataRow
ââ9 @
)
ââ@ A
;
ââA B
return
ää 
	SqlHelper
ää  
.
ää  !
ExecuteDataset
ää! /
(
ää/ 0
transaction
ää0 ;
,
ää; <
CommandType
ää= H
.
ääH I
StoredProcedure
ääI X
,
ääX Y
spName
ääZ `
,
ää` a
commandParameters
ääb s
)
ääs t
;
äät u
}
åå 
else
ææ 
{
çç 
return
èè 
	SqlHelper
èè  
.
èè  !
ExecuteDataset
èè! /
(
èè/ 0
transaction
èè0 ;
,
èè; <
CommandType
èè= H
.
èèH I
StoredProcedure
èèI X
,
èèX Y
spName
èèZ `
)
èè` a
;
èèa b
}
éé 
}
êê 	
public
ùù 
static
ùù 
SqlDataReader
ùù #&
ExecuteReaderTypedParams
ùù$ <
(
ùù< =
String
ùù= C
connectionString
ùùD T
,
ùùT U
String
ùùV \
spName
ùù] c
,
ùùc d
DataRow
ùùe l
dataRow
ùùm t
)
ùùt u
{
úú 	
if
ûû 
(
ûû 
connectionString
ûû  
==
ûû! #
null
ûû$ (
||
ûû) +
connectionString
ûû, <
.
ûû< =
Length
ûû= C
==
ûûD F
$num
ûûG H
)
ûûH I
throw
ûûJ O
new
ûûP S#
ArgumentNullException
ûûT i
(
ûûi j
$str
ûûj |
)
ûû| }
;
ûû} ~
if
üü 
(
üü 
spName
üü 
==
üü 
null
üü 
||
üü !
spName
üü" (
.
üü( )
Length
üü) /
==
üü0 2
$num
üü3 4
)
üü4 5
throw
üü6 ;
new
üü< ?#
ArgumentNullException
üü@ U
(
üüU V
$str
üüV ^
)
üü^ _
;
üü_ `
if
ÿÿ 
(
ÿÿ 
dataRow
ÿÿ 
!=
ÿÿ 
null
ÿÿ 
&&
ÿÿ  "
dataRow
ÿÿ# *
.
ÿÿ* +
	ItemArray
ÿÿ+ 4
.
ÿÿ4 5
Length
ÿÿ5 ;
>
ÿÿ< =
$num
ÿÿ> ?
)
ÿÿ? @
{
€€ 
SqlParameter
‚‚ 
[
‚‚ 
]
‚‚ 
commandParameters
‚‚ 0
=
‚‚1 2%
SqlHelperParameterCache
‚‚3 J
.
‚‚J K
GetSpParameterSet
‚‚K \
(
‚‚\ ]
connectionString
‚‚] m
,
‚‚m n
spName
‚‚o u
)
‚‚u v
;
‚‚v w#
AssignParameterValues
…… %
(
……% &
commandParameters
……& 7
,
……7 8
dataRow
……9 @
)
……@ A
;
……A B
return
‡‡ 
	SqlHelper
‡‡  
.
‡‡  !
ExecuteReader
‡‡! .
(
‡‡. /
connectionString
‡‡/ ?
,
‡‡? @
CommandType
‡‡A L
.
‡‡L M
StoredProcedure
‡‡M \
,
‡‡\ ]
spName
‡‡^ d
,
‡‡d e
commandParameters
‡‡f w
)
‡‡w x
;
‡‡x y
}
ˆˆ 
else
‰‰ 
{
ŠŠ 
return
‹‹ 
	SqlHelper
‹‹  
.
‹‹  !
ExecuteReader
‹‹! .
(
‹‹. /
connectionString
‹‹/ ?
,
‹‹? @
CommandType
‹‹A L
.
‹‹L M
StoredProcedure
‹‹M \
,
‹‹\ ]
spName
‹‹^ d
)
‹‹d e
;
‹‹e f
}
ŒŒ 
}
 	
public
šš 
static
šš 
SqlDataReader
šš #&
ExecuteReaderTypedParams
šš$ <
(
šš< =
SqlConnection
šš= J

connection
ššK U
,
ššU V
String
ššW ]
spName
šš^ d
,
ššd e
DataRow
ššf m
dataRow
ššn u
)
ššu v
{
›› 	
if
œœ 
(
œœ 

connection
œœ 
==
œœ 
null
œœ "
)
œœ" #
throw
œœ$ )
new
œœ* -#
ArgumentNullException
œœ. C
(
œœC D
$str
œœD P
)
œœP Q
;
œœQ R
if
 
(
 
spName
 
==
 
null
 
||
 !
spName
" (
.
( )
Length
) /
==
0 2
$num
3 4
)
4 5
throw
6 ;
new
< ?#
ArgumentNullException
@ U
(
U V
$str
V ^
)
^ _
;
_ `
if
   
(
   
dataRow
   
!=
   
null
   
&&
    "
dataRow
  # *
.
  * +
	ItemArray
  + 4
.
  4 5
Length
  5 ;
>
  < =
$num
  > ?
)
  ? @
{
¡¡ 
SqlParameter
££ 
[
££ 
]
££ 
commandParameters
££ 0
=
££1 2%
SqlHelperParameterCache
££3 J
.
££J K
GetSpParameterSet
££K \
(
££\ ]

connection
££] g
,
££g h
spName
££i o
)
££o p
;
££p q#
AssignParameterValues
¦¦ %
(
¦¦% &
commandParameters
¦¦& 7
,
¦¦7 8
dataRow
¦¦9 @
)
¦¦@ A
;
¦¦A B
return
¨¨ 
	SqlHelper
¨¨  
.
¨¨  !
ExecuteReader
¨¨! .
(
¨¨. /

connection
¨¨/ 9
,
¨¨9 :
CommandType
¨¨; F
.
¨¨F G
StoredProcedure
¨¨G V
,
¨¨V W
spName
¨¨X ^
,
¨¨^ _
commandParameters
¨¨` q
)
¨¨q r
;
¨¨r s
}
©© 
else
ªª 
{
«« 
return
¬¬ 
	SqlHelper
¬¬  
.
¬¬  !
ExecuteReader
¬¬! .
(
¬¬. /

connection
¬¬/ 9
,
¬¬9 :
CommandType
¬¬; F
.
¬¬F G
StoredProcedure
¬¬G V
,
¬¬V W
spName
¬¬X ^
)
¬¬^ _
;
¬¬_ `
}
­­ 
}
®® 	
public
ºº 
static
ºº 
SqlDataReader
ºº #&
ExecuteReaderTypedParams
ºº$ <
(
ºº< =
SqlTransaction
ºº= K
transaction
ººL W
,
ººW X
String
ººY _
spName
ºº` f
,
ººf g
DataRow
ººh o
dataRow
ººp w
)
ººw x
{
»» 	
if
¼¼ 
(
¼¼ 
transaction
¼¼ 
==
¼¼ 
null
¼¼ #
)
¼¼# $
throw
¼¼% *
new
¼¼+ .#
ArgumentNullException
¼¼/ D
(
¼¼D E
$str
¼¼E R
)
¼¼R S
;
¼¼S T
if
½½ 
(
½½ 
transaction
½½ 
!=
½½ 
null
½½ #
&&
½½$ &
transaction
½½' 2
.
½½2 3

Connection
½½3 =
==
½½> @
null
½½A E
)
½½E F
throw
½½G L
new
½½M P
ArgumentException
½½Q b
(
½½b c
$str½½c ´
,½½´ µ
$str½½¶ Ã
)½½Ã Ä
;½½Ä Å
if
¾¾ 
(
¾¾ 
spName
¾¾ 
==
¾¾ 
null
¾¾ 
||
¾¾ !
spName
¾¾" (
.
¾¾( )
Length
¾¾) /
==
¾¾0 2
$num
¾¾3 4
)
¾¾4 5
throw
¾¾6 ;
new
¾¾< ?#
ArgumentNullException
¾¾@ U
(
¾¾U V
$str
¾¾V ^
)
¾¾^ _
;
¾¾_ `
if
ÁÁ 
(
ÁÁ 
dataRow
ÁÁ 
!=
ÁÁ 
null
ÁÁ 
&&
ÁÁ  "
dataRow
ÁÁ# *
.
ÁÁ* +
	ItemArray
ÁÁ+ 4
.
ÁÁ4 5
Length
ÁÁ5 ;
>
ÁÁ< =
$num
ÁÁ> ?
)
ÁÁ? @
{
ÂÂ 
SqlParameter
ÄÄ 
[
ÄÄ 
]
ÄÄ 
commandParameters
ÄÄ 0
=
ÄÄ1 2%
SqlHelperParameterCache
ÄÄ3 J
.
ÄÄJ K
GetSpParameterSet
ÄÄK \
(
ÄÄ\ ]
transaction
ÄÄ] h
.
ÄÄh i

Connection
ÄÄi s
,
ÄÄs t
spName
ÄÄu {
)
ÄÄ{ |
;
ÄÄ| }#
AssignParameterValues
ÇÇ %
(
ÇÇ% &
commandParameters
ÇÇ& 7
,
ÇÇ7 8
dataRow
ÇÇ9 @
)
ÇÇ@ A
;
ÇÇA B
return
ÉÉ 
	SqlHelper
ÉÉ  
.
ÉÉ  !
ExecuteReader
ÉÉ! .
(
ÉÉ. /
transaction
ÉÉ/ :
,
ÉÉ: ;
CommandType
ÉÉ< G
.
ÉÉG H
StoredProcedure
ÉÉH W
,
ÉÉW X
spName
ÉÉY _
,
ÉÉ_ `
commandParameters
ÉÉa r
)
ÉÉr s
;
ÉÉs t
}
ÊÊ 
else
ËË 
{
ÌÌ 
return
ÍÍ 
	SqlHelper
ÍÍ  
.
ÍÍ  !
ExecuteReader
ÍÍ! .
(
ÍÍ. /
transaction
ÍÍ/ :
,
ÍÍ: ;
CommandType
ÍÍ< G
.
ÍÍG H
StoredProcedure
ÍÍH W
,
ÍÍW X
spName
ÍÍY _
)
ÍÍ_ `
;
ÍÍ` a
}
ÎÎ 
}
ÏÏ 	
public
İİ 
static
İİ 
object
İİ &
ExecuteScalarTypedParams
İİ 5
(
İİ5 6
String
İİ6 <
connectionString
İİ= M
,
İİM N
String
İİO U
spName
İİV \
,
İİ\ ]
DataRow
İİ^ e
dataRow
İİf m
)
İİm n
{
ŞŞ 	
if
ßß 
(
ßß 
connectionString
ßß  
==
ßß! #
null
ßß$ (
||
ßß) +
connectionString
ßß, <
.
ßß< =
Length
ßß= C
==
ßßD F
$num
ßßG H
)
ßßH I
throw
ßßJ O
new
ßßP S#
ArgumentNullException
ßßT i
(
ßßi j
$str
ßßj |
)
ßß| }
;
ßß} ~
if
àà 
(
àà 
spName
àà 
==
àà 
null
àà 
||
àà !
spName
àà" (
.
àà( )
Length
àà) /
==
àà0 2
$num
àà3 4
)
àà4 5
throw
àà6 ;
new
àà< ?#
ArgumentNullException
àà@ U
(
ààU V
$str
ààV ^
)
àà^ _
;
àà_ `
if
ãã 
(
ãã 
dataRow
ãã 
!=
ãã 
null
ãã 
&&
ãã  "
dataRow
ãã# *
.
ãã* +
	ItemArray
ãã+ 4
.
ãã4 5
Length
ãã5 ;
>
ãã< =
$num
ãã> ?
)
ãã? @
{
ää 
SqlParameter
ææ 
[
ææ 
]
ææ 
commandParameters
ææ 0
=
ææ1 2%
SqlHelperParameterCache
ææ3 J
.
ææJ K
GetSpParameterSet
ææK \
(
ææ\ ]
connectionString
ææ] m
,
ææm n
spName
ææo u
)
ææu v
;
ææv w#
AssignParameterValues
éé %
(
éé% &
commandParameters
éé& 7
,
éé7 8
dataRow
éé9 @
)
éé@ A
;
ééA B
return
ëë 
	SqlHelper
ëë  
.
ëë  !
ExecuteScalar
ëë! .
(
ëë. /
connectionString
ëë/ ?
,
ëë? @
CommandType
ëëA L
.
ëëL M
StoredProcedure
ëëM \
,
ëë\ ]
spName
ëë^ d
,
ëëd e
commandParameters
ëëf w
)
ëëw x
;
ëëx y
}
ìì 
else
íí 
{
îî 
return
ïï 
	SqlHelper
ïï  
.
ïï  !
ExecuteScalar
ïï! .
(
ïï. /
connectionString
ïï/ ?
,
ïï? @
CommandType
ïïA L
.
ïïL M
StoredProcedure
ïïM \
,
ïï\ ]
spName
ïï^ d
)
ïïd e
;
ïïe f
}
ğğ 
}
ññ 	
public
ıı 
static
ıı 
object
ıı &
ExecuteScalarTypedParams
ıı 5
(
ıı5 6
SqlConnection
ıı6 C

connection
ııD N
,
ııN O
String
ııP V
spName
ııW ]
,
ıı] ^
DataRow
ıı_ f
dataRow
ııg n
)
ıın o
{
şş 	
if
ÿÿ 
(
ÿÿ 

connection
ÿÿ 
==
ÿÿ 
null
ÿÿ "
)
ÿÿ" #
{
€€ 
throw
 
new
 #
ArgumentNullException
 /
(
/ 0
$str
0 <
)
< =
;
= >
}
‚‚ 
if
„„ 
(
„„ 
spName
„„ 
==
„„ 
null
„„ 
||
„„ !
spName
„„" (
.
„„( )
Length
„„) /
==
„„0 2
$num
„„3 4
)
„„4 5
{
…… 
throw
†† 
new
†† #
ArgumentNullException
†† /
(
††/ 0
$str
††0 8
)
††8 9
;
††9 :
}
‡‡ 
if
ŠŠ 
(
ŠŠ 
dataRow
ŠŠ 
!=
ŠŠ 
null
ŠŠ 
&&
ŠŠ  "
dataRow
ŠŠ# *
.
ŠŠ* +
	ItemArray
ŠŠ+ 4
.
ŠŠ4 5
Length
ŠŠ5 ;
>
ŠŠ< =
$num
ŠŠ> ?
)
ŠŠ? @
{
‹‹ 
SqlParameter
 
[
 
]
 
commandParameters
 0
=
1 2%
SqlHelperParameterCache
3 J
.
J K
GetSpParameterSet
K \
(
\ ]

connection
] g
,
g h
spName
i o
)
o p
;
p q#
AssignParameterValues
 %
(
% &
commandParameters
& 7
,
7 8
dataRow
9 @
)
@ A
;
A B
return
’’ 
	SqlHelper
’’  
.
’’  !
ExecuteScalar
’’! .
(
’’. /

connection
’’/ 9
,
’’9 :
CommandType
’’; F
.
’’F G
StoredProcedure
’’G V
,
’’V W
spName
’’X ^
,
’’^ _
commandParameters
’’` q
)
’’q r
;
’’r s
}
““ 
else
”” 
{
•• 
return
–– 
	SqlHelper
––  
.
––  !
ExecuteScalar
––! .
(
––. /

connection
––/ 9
,
––9 :
CommandType
––; F
.
––F G
StoredProcedure
––G V
,
––V W
spName
––X ^
)
––^ _
;
––_ `
}
—— 
}
˜˜ 	
public
¤¤ 
static
¤¤ 
object
¤¤ &
ExecuteScalarTypedParams
¤¤ 5
(
¤¤5 6
SqlTransaction
¤¤6 D
transaction
¤¤E P
,
¤¤P Q
String
¤¤R X
spName
¤¤Y _
,
¤¤_ `
DataRow
¤¤a h
dataRow
¤¤i p
)
¤¤p q
{
¥¥ 	
if
¦¦ 
(
¦¦ 
transaction
¦¦ 
==
¦¦ 
null
¦¦ #
)
¦¦# $
throw
¦¦% *
new
¦¦+ .#
ArgumentNullException
¦¦/ D
(
¦¦D E
$str
¦¦E R
)
¦¦R S
;
¦¦S T
if
§§ 
(
§§ 
transaction
§§ 
!=
§§ 
null
§§ #
&&
§§$ &
transaction
§§' 2
.
§§2 3

Connection
§§3 =
==
§§> @
null
§§A E
)
§§E F
throw
§§G L
new
§§M P
ArgumentException
§§Q b
(
§§b c
$str§§c ´
,§§´ µ
$str§§¶ Ã
)§§Ã Ä
;§§Ä Å
if
¨¨ 
(
¨¨ 
spName
¨¨ 
==
¨¨ 
null
¨¨ 
||
¨¨ !
spName
¨¨" (
.
¨¨( )
Length
¨¨) /
==
¨¨0 2
$num
¨¨3 4
)
¨¨4 5
throw
¨¨6 ;
new
¨¨< ?#
ArgumentNullException
¨¨@ U
(
¨¨U V
$str
¨¨V ^
)
¨¨^ _
;
¨¨_ `
if
«« 
(
«« 
dataRow
«« 
!=
«« 
null
«« 
&&
««  "
dataRow
««# *
.
««* +
	ItemArray
««+ 4
.
««4 5
Length
««5 ;
>
««< =
$num
««> ?
)
««? @
{
¬¬ 
SqlParameter
®® 
[
®® 
]
®® 
commandParameters
®® 0
=
®®1 2%
SqlHelperParameterCache
®®3 J
.
®®J K
GetSpParameterSet
®®K \
(
®®\ ]
transaction
®®] h
.
®®h i

Connection
®®i s
,
®®s t
spName
®®u {
)
®®{ |
;
®®| }#
AssignParameterValues
±± %
(
±±% &
commandParameters
±±& 7
,
±±7 8
dataRow
±±9 @
)
±±@ A
;
±±A B
return
³³ 
	SqlHelper
³³  
.
³³  !
ExecuteScalar
³³! .
(
³³. /
transaction
³³/ :
,
³³: ;
CommandType
³³< G
.
³³G H
StoredProcedure
³³H W
,
³³W X
spName
³³Y _
,
³³_ `
commandParameters
³³a r
)
³³r s
;
³³s t
}
´´ 
else
µµ 
{
¶¶ 
return
·· 
	SqlHelper
··  
.
··  !
ExecuteScalar
··! .
(
··. /
transaction
··/ :
,
··: ;
CommandType
··< G
.
··G H
StoredProcedure
··H W
,
··W X
spName
··Y _
)
··_ `
;
··` a
}
¸¸ 
}
¹¹ 	
public
ÇÇ 
static
ÇÇ 
	XmlReader
ÇÇ )
ExecuteXmlReaderTypedParams
ÇÇ  ;
(
ÇÇ; <
SqlConnection
ÇÇ< I

connection
ÇÇJ T
,
ÇÇT U
String
ÇÇV \
spName
ÇÇ] c
,
ÇÇc d
DataRow
ÇÇe l
dataRow
ÇÇm t
)
ÇÇt u
{
ÈÈ 	
if
ÉÉ 
(
ÉÉ 

connection
ÉÉ 
==
ÉÉ 
null
ÉÉ "
)
ÉÉ" #
throw
ÉÉ$ )
new
ÉÉ* -#
ArgumentNullException
ÉÉ. C
(
ÉÉC D
$str
ÉÉD P
)
ÉÉP Q
;
ÉÉQ R
if
ÊÊ 
(
ÊÊ 
spName
ÊÊ 
==
ÊÊ 
null
ÊÊ 
||
ÊÊ !
spName
ÊÊ" (
.
ÊÊ( )
Length
ÊÊ) /
==
ÊÊ0 2
$num
ÊÊ3 4
)
ÊÊ4 5
throw
ÊÊ6 ;
new
ÊÊ< ?#
ArgumentNullException
ÊÊ@ U
(
ÊÊU V
$str
ÊÊV ^
)
ÊÊ^ _
;
ÊÊ_ `
if
ÍÍ 
(
ÍÍ 
dataRow
ÍÍ 
!=
ÍÍ 
null
ÍÍ 
&&
ÍÍ  "
dataRow
ÍÍ# *
.
ÍÍ* +
	ItemArray
ÍÍ+ 4
.
ÍÍ4 5
Length
ÍÍ5 ;
>
ÍÍ< =
$num
ÍÍ> ?
)
ÍÍ? @
{
ÎÎ 
SqlParameter
ĞĞ 
[
ĞĞ 
]
ĞĞ 
commandParameters
ĞĞ 0
=
ĞĞ1 2%
SqlHelperParameterCache
ĞĞ3 J
.
ĞĞJ K
GetSpParameterSet
ĞĞK \
(
ĞĞ\ ]

connection
ĞĞ] g
,
ĞĞg h
spName
ĞĞi o
)
ĞĞo p
;
ĞĞp q#
AssignParameterValues
ÓÓ %
(
ÓÓ% &
commandParameters
ÓÓ& 7
,
ÓÓ7 8
dataRow
ÓÓ9 @
)
ÓÓ@ A
;
ÓÓA B
return
ÕÕ 
	SqlHelper
ÕÕ  
.
ÕÕ  !
ExecuteXmlReader
ÕÕ! 1
(
ÕÕ1 2

connection
ÕÕ2 <
,
ÕÕ< =
CommandType
ÕÕ> I
.
ÕÕI J
StoredProcedure
ÕÕJ Y
,
ÕÕY Z
spName
ÕÕ[ a
,
ÕÕa b
commandParameters
ÕÕc t
)
ÕÕt u
;
ÕÕu v
}
ÖÖ 
else
×× 
{
ØØ 
return
ÙÙ 
	SqlHelper
ÙÙ  
.
ÙÙ  !
ExecuteXmlReader
ÙÙ! 1
(
ÙÙ1 2

connection
ÙÙ2 <
,
ÙÙ< =
CommandType
ÙÙ> I
.
ÙÙI J
StoredProcedure
ÙÙJ Y
,
ÙÙY Z
spName
ÙÙ[ a
)
ÙÙa b
;
ÙÙb c
}
ÚÚ 
}
ÛÛ 	
public
çç 
static
çç 
	XmlReader
çç )
ExecuteXmlReaderTypedParams
çç  ;
(
çç; <
SqlTransaction
çç< J
transaction
ççK V
,
ççV W
String
ççX ^
spName
çç_ e
,
ççe f
DataRow
ççg n
dataRow
çço v
)
ççv w
{
èè 	
if
éé 
(
éé 
transaction
éé 
==
éé 
null
éé #
)
éé# $
throw
éé% *
new
éé+ .#
ArgumentNullException
éé/ D
(
ééD E
$str
ééE R
)
ééR S
;
ééS T
if
êê 
(
êê 
transaction
êê 
!=
êê 
null
êê #
&&
êê$ &
transaction
êê' 2
.
êê2 3

Connection
êê3 =
==
êê> @
null
êêA E
)
êêE F
throw
êêG L
new
êêM P
ArgumentException
êêQ b
(
êêb c
$strêêc ´
,êê´ µ
$strêê¶ Ã
)êêÃ Ä
;êêÄ Å
if
ëë 
(
ëë 
spName
ëë 
==
ëë 
null
ëë 
||
ëë !
spName
ëë" (
.
ëë( )
Length
ëë) /
==
ëë0 2
$num
ëë3 4
)
ëë4 5
throw
ëë6 ;
new
ëë< ?#
ArgumentNullException
ëë@ U
(
ëëU V
$str
ëëV ^
)
ëë^ _
;
ëë_ `
if
îî 
(
îî 
dataRow
îî 
!=
îî 
null
îî 
&&
îî  "
dataRow
îî# *
.
îî* +
	ItemArray
îî+ 4
.
îî4 5
Length
îî5 ;
>
îî< =
$num
îî> ?
)
îî? @
{
ïï 
SqlParameter
ññ 
[
ññ 
]
ññ 
commandParameters
ññ 0
=
ññ1 2%
SqlHelperParameterCache
ññ3 J
.
ññJ K
GetSpParameterSet
ññK \
(
ññ\ ]
transaction
ññ] h
.
ññh i

Connection
ññi s
,
ññs t
spName
ññu {
)
ññ{ |
;
ññ| }#
AssignParameterValues
ôô %
(
ôô% &
commandParameters
ôô& 7
,
ôô7 8
dataRow
ôô9 @
)
ôô@ A
;
ôôA B
return
öö 
	SqlHelper
öö  
.
öö  !
ExecuteXmlReader
öö! 1
(
öö1 2
transaction
öö2 =
,
öö= >
CommandType
öö? J
.
ööJ K
StoredProcedure
ööK Z
,
ööZ [
spName
öö\ b
,
ööb c
commandParameters
ööd u
)
ööu v
;
ööv w
}
÷÷ 
else
øø 
{
ùù 
return
úú 
	SqlHelper
úú  
.
úú  !
ExecuteXmlReader
úú! 1
(
úú1 2
transaction
úú2 =
,
úú= >
CommandType
úú? J
.
úúJ K
StoredProcedure
úúK Z
,
úúZ [
spName
úú\ b
)
úúb c
;
úúc d
}
ûû 
}
üü 	
}
ÿÿ 
public
…… 

sealed
…… 
class
…… %
SqlHelperParameterCache
…… /
{
†† 
private
‹‹ %
SqlHelperParameterCache
‹‹ '
(
‹‹' (
)
‹‹( )
{
‹‹* +
}
‹‹, -
private
 
static
 
	Hashtable
  

paramCache
! +
=
, -
	Hashtable
. 7
.
7 8
Synchronized
8 D
(
D E
new
E H
	Hashtable
I R
(
R S
)
S T
)
T U
;
U V
private
–– 
static
–– 
SqlParameter
–– #
[
––# $
]
––$ %$
DiscoverSpParameterSet
––& <
(
––< =
SqlConnection
––= J

connection
––K U
,
––U V
string
––W ]
spName
––^ d
,
––d e
bool
––f j*
includeReturnValueParameter––k †
)––† ‡
{
—— 	
if
˜˜ 
(
˜˜ 

connection
˜˜ 
==
˜˜ 
null
˜˜ "
)
˜˜" #
throw
˜˜$ )
new
˜˜* -#
ArgumentNullException
˜˜. C
(
˜˜C D
$str
˜˜D P
)
˜˜P Q
;
˜˜Q R
if
™™ 
(
™™ 
spName
™™ 
==
™™ 
null
™™ 
||
™™ !
spName
™™" (
.
™™( )
Length
™™) /
==
™™0 2
$num
™™3 4
)
™™4 5
throw
™™6 ;
new
™™< ?#
ArgumentNullException
™™@ U
(
™™U V
$str
™™V ^
)
™™^ _
;
™™_ `

SqlCommand
›› 
cmd
›› 
=
›› 
new
››  

SqlCommand
››! +
(
››+ ,
spName
››, 2
,
››2 3

connection
››4 >
)
››> ?
;
››? @
cmd
œœ 
.
œœ 
CommandType
œœ 
=
œœ 
CommandType
œœ )
.
œœ) *
StoredProcedure
œœ* 9
;
œœ9 :

connection
 
.
 
Open
 
(
 
)
 
;
 
SqlCommandBuilder
ŸŸ 
.
ŸŸ 
DeriveParameters
ŸŸ .
(
ŸŸ. /
cmd
ŸŸ/ 2
)
ŸŸ2 3
;
ŸŸ3 4

connection
   
.
   
Close
   
(
   
)
   
;
   
if
¢¢ 
(
¢¢ 
!
¢¢ )
includeReturnValueParameter
¢¢ ,
)
¢¢, -
{
££ 
cmd
¤¤ 
.
¤¤ 

Parameters
¤¤ 
.
¤¤ 
RemoveAt
¤¤ '
(
¤¤' (
$num
¤¤( )
)
¤¤) *
;
¤¤* +
}
¥¥ 
SqlParameter
§§ 
[
§§ 
]
§§ "
discoveredParameters
§§ /
=
§§0 1
new
§§2 5
SqlParameter
§§6 B
[
§§B C
cmd
§§C F
.
§§F G

Parameters
§§G Q
.
§§Q R
Count
§§R W
]
§§W X
;
§§X Y
cmd
©© 
.
©© 

Parameters
©© 
.
©© 
CopyTo
©© !
(
©©! ""
discoveredParameters
©©" 6
,
©©6 7
$num
©©8 9
)
©©9 :
;
©©: ;
foreach
¬¬ 
(
¬¬ 
SqlParameter
¬¬ !!
discoveredParameter
¬¬" 5
in
¬¬6 8"
discoveredParameters
¬¬9 M
)
¬¬M N
{
­­ !
discoveredParameter
®® #
.
®®# $
Value
®®$ )
=
®®* +
DBNull
®®, 2
.
®®2 3
Value
®®3 8
;
®®8 9
}
¯¯ 
return
°° "
discoveredParameters
°° '
;
°°' (
}
±± 	
private
¸¸ 
static
¸¸ 
SqlParameter
¸¸ #
[
¸¸# $
]
¸¸$ %
CloneParameters
¸¸& 5
(
¸¸5 6
SqlParameter
¸¸6 B
[
¸¸B C
]
¸¸C D 
originalParameters
¸¸E W
)
¸¸W X
{
¹¹ 	
SqlParameter
ºº 
[
ºº 
]
ºº 
clonedParameters
ºº +
=
ºº, -
new
ºº. 1
SqlParameter
ºº2 >
[
ºº> ? 
originalParameters
ºº? Q
.
ººQ R
Length
ººR X
]
ººX Y
;
ººY Z
for
¼¼ 
(
¼¼ 
int
¼¼ 
i
¼¼ 
=
¼¼ 
$num
¼¼ 
,
¼¼ 
j
¼¼ 
=
¼¼  
originalParameters
¼¼  2
.
¼¼2 3
Length
¼¼3 9
;
¼¼9 :
i
¼¼; <
<
¼¼= >
j
¼¼? @
;
¼¼@ A
i
¼¼B C
++
¼¼C E
)
¼¼E F
{
½½ 
clonedParameters
¾¾  
[
¾¾  !
i
¾¾! "
]
¾¾" #
=
¾¾$ %
(
¾¾& '
SqlParameter
¾¾' 3
)
¾¾3 4
(
¾¾4 5
(
¾¾5 6

ICloneable
¾¾6 @
)
¾¾@ A 
originalParameters
¾¾A S
[
¾¾S T
i
¾¾T U
]
¾¾U V
)
¾¾V W
.
¾¾W X
Clone
¾¾X ]
(
¾¾] ^
)
¾¾^ _
;
¾¾_ `
}
¿¿ 
return
ÁÁ 
clonedParameters
ÁÁ #
;
ÁÁ# $
}
ÂÂ 	
public
ÎÎ 
static
ÎÎ 
void
ÎÎ 
CacheParameterSet
ÎÎ ,
(
ÎÎ, -
string
ÎÎ- 3
connectionString
ÎÎ4 D
,
ÎÎD E
string
ÎÎF L
commandText
ÎÎM X
,
ÎÎX Y
params
ÎÎZ `
SqlParameter
ÎÎa m
[
ÎÎm n
]
ÎÎn o 
commandParametersÎÎp 
)ÎÎ ‚
{
ÏÏ 	
if
ĞĞ 
(
ĞĞ 
connectionString
ĞĞ  
==
ĞĞ! #
null
ĞĞ$ (
||
ĞĞ) +
connectionString
ĞĞ, <
.
ĞĞ< =
Length
ĞĞ= C
==
ĞĞD F
$num
ĞĞG H
)
ĞĞH I
throw
ĞĞJ O
new
ĞĞP S#
ArgumentNullException
ĞĞT i
(
ĞĞi j
$str
ĞĞj |
)
ĞĞ| }
;
ĞĞ} ~
if
ÑÑ 
(
ÑÑ 
commandText
ÑÑ 
==
ÑÑ 
null
ÑÑ #
||
ÑÑ$ &
commandText
ÑÑ' 2
.
ÑÑ2 3
Length
ÑÑ3 9
==
ÑÑ: <
$num
ÑÑ= >
)
ÑÑ> ?
throw
ÑÑ@ E
new
ÑÑF I#
ArgumentNullException
ÑÑJ _
(
ÑÑ_ `
$str
ÑÑ` m
)
ÑÑm n
;
ÑÑn o
string
ÓÓ 
hashKey
ÓÓ 
=
ÓÓ 
connectionString
ÓÓ -
+
ÓÓ. /
$str
ÓÓ0 3
+
ÓÓ4 5
commandText
ÓÓ6 A
;
ÓÓA B

paramCache
ÕÕ 
[
ÕÕ 
hashKey
ÕÕ 
]
ÕÕ 
=
ÕÕ  !
commandParameters
ÕÕ" 3
;
ÕÕ3 4
}
ÖÖ 	
public
ŞŞ 
static
ŞŞ 
SqlParameter
ŞŞ "
[
ŞŞ" #
]
ŞŞ# $#
GetCachedParameterSet
ŞŞ% :
(
ŞŞ: ;
string
ŞŞ; A
connectionString
ŞŞB R
,
ŞŞR S
string
ŞŞT Z
commandText
ŞŞ[ f
)
ŞŞf g
{
ßß 	
if
àà 
(
àà 
connectionString
àà  
==
àà! #
null
àà$ (
||
àà) +
connectionString
àà, <
.
àà< =
Length
àà= C
==
ààD F
$num
ààG H
)
ààH I
throw
ààJ O
new
ààP S#
ArgumentNullException
ààT i
(
àài j
$str
ààj |
)
àà| }
;
àà} ~
if
áá 
(
áá 
commandText
áá 
==
áá 
null
áá #
||
áá$ &
commandText
áá' 2
.
áá2 3
Length
áá3 9
==
áá: <
$num
áá= >
)
áá> ?
throw
áá@ E
new
ááF I#
ArgumentNullException
ááJ _
(
áá_ `
$str
áá` m
)
áám n
;
áán o
string
ãã 
hashKey
ãã 
=
ãã 
connectionString
ãã -
+
ãã. /
$str
ãã0 3
+
ãã4 5
commandText
ãã6 A
;
ããA B
SqlParameter
åå 
[
åå 
]
åå 
cachedParameters
åå +
=
åå, -

paramCache
åå. 8
[
åå8 9
hashKey
åå9 @
]
åå@ A
as
ååB D
SqlParameter
ååE Q
[
ååQ R
]
ååR S
;
ååS T
if
ææ 
(
ææ 
cachedParameters
ææ  
==
ææ! #
null
ææ$ (
)
ææ( )
{
çç 
return
èè 
null
èè 
;
èè 
}
éé 
else
êê 
{
ëë 
return
ìì 
CloneParameters
ìì &
(
ìì& '
cachedParameters
ìì' 7
)
ìì7 8
;
ìì8 9
}
íí 
}
îî 	
public
ıı 
static
ıı 
SqlParameter
ıı "
[
ıı" #
]
ıı# $
GetSpParameterSet
ıı% 6
(
ıı6 7
string
ıı7 =
connectionString
ıı> N
,
ııN O
string
ııP V
spName
ııW ]
)
ıı] ^
{
şş 	
return
ÿÿ 
GetSpParameterSet
ÿÿ $
(
ÿÿ$ %
connectionString
ÿÿ% 5
,
ÿÿ5 6
spName
ÿÿ7 =
,
ÿÿ= >
false
ÿÿ? D
)
ÿÿD E
;
ÿÿE F
}
€€ 	
public
ŒŒ 
static
ŒŒ 
SqlParameter
ŒŒ "
[
ŒŒ" #
]
ŒŒ# $
GetSpParameterSet
ŒŒ% 6
(
ŒŒ6 7
string
ŒŒ7 =
connectionString
ŒŒ> N
,
ŒŒN O
string
ŒŒP V
spName
ŒŒW ]
,
ŒŒ] ^
bool
ŒŒ_ c)
includeReturnValueParameter
ŒŒd 
)ŒŒ €
{
 	
if
 
(
 
connectionString
  
==
! #
null
$ (
||
) +
connectionString
, <
.
< =
Length
= C
==
D F
$num
G H
)
H I
throw
J O
new
P S#
ArgumentNullException
T i
(
i j
$str
j |
)
| }
;
} ~
if
 
(
 
spName
 
==
 
null
 
||
 !
spName
" (
.
( )
Length
) /
==
0 2
$num
3 4
)
4 5
throw
6 ;
new
< ?#
ArgumentNullException
@ U
(
U V
$str
V ^
)
^ _
;
_ `
using
‘‘ 
(
‘‘ 
SqlConnection
‘‘  

connection
‘‘! +
=
‘‘, -
new
‘‘. 1
SqlConnection
‘‘2 ?
(
‘‘? @
connectionString
‘‘@ P
)
‘‘P Q
)
‘‘Q R
{
’’ 
return
““ '
GetSpParameterSetInternal
““ 0
(
““0 1

connection
““1 ;
,
““; <
spName
““= C
,
““C D)
includeReturnValueParameter
““E `
)
““` a
;
““a b
}
”” 
}
•• 	
internal
   
static
   
SqlParameter
   $
[
  $ %
]
  % &
GetSpParameterSet
  ' 8
(
  8 9
SqlConnection
  9 F

connection
  G Q
,
  Q R
string
  S Y
spName
  Z `
)
  ` a
{
¡¡ 	
return
¢¢ 
GetSpParameterSet
¢¢ $
(
¢¢$ %

connection
¢¢% /
,
¢¢/ 0
spName
¢¢1 7
,
¢¢7 8
false
¢¢9 >
)
¢¢> ?
;
¢¢? @
}
££ 	
internal
¯¯ 
static
¯¯ 
SqlParameter
¯¯ $
[
¯¯$ %
]
¯¯% &
GetSpParameterSet
¯¯' 8
(
¯¯8 9
SqlConnection
¯¯9 F

connection
¯¯G Q
,
¯¯Q R
string
¯¯S Y
spName
¯¯Z `
,
¯¯` a
bool
¯¯b f*
includeReturnValueParameter¯¯g ‚
)¯¯‚ ƒ
{
°° 	
if
±± 
(
±± 

connection
±± 
==
±± 
null
±± "
)
±±" #
throw
±±$ )
new
±±* -#
ArgumentNullException
±±. C
(
±±C D
$str
±±D P
)
±±P Q
;
±±Q R
using
²² 
(
²² 
SqlConnection
²²  
clonedConnection
²²! 1
=
²²2 3
(
²²4 5
SqlConnection
²²5 B
)
²²B C
(
²²C D
(
²²D E

ICloneable
²²E O
)
²²O P

connection
²²P Z
)
²²Z [
.
²²[ \
Clone
²²\ a
(
²²a b
)
²²b c
)
²²c d
{
³³ 
return
´´ '
GetSpParameterSetInternal
´´ 0
(
´´0 1
clonedConnection
´´1 A
,
´´A B
spName
´´C I
,
´´I J)
includeReturnValueParameter
´´K f
)
´´f g
;
´´g h
}
µµ 
}
¶¶ 	
private
¿¿ 
static
¿¿ 
SqlParameter
¿¿ #
[
¿¿# $
]
¿¿$ %'
GetSpParameterSetInternal
¿¿& ?
(
¿¿? @
SqlConnection
¿¿@ M

connection
¿¿N X
,
¿¿X Y
string
¿¿Z `
spName
¿¿a g
,
¿¿g h
bool
¿¿i m*
includeReturnValueParameter¿¿n ‰
)¿¿‰ Š
{
ÀÀ 	
if
ÁÁ 
(
ÁÁ 

connection
ÁÁ 
==
ÁÁ 
null
ÁÁ "
)
ÁÁ" #
throw
ÁÁ$ )
new
ÁÁ* -#
ArgumentNullException
ÁÁ. C
(
ÁÁC D
$str
ÁÁD P
)
ÁÁP Q
;
ÁÁQ R
if
ÂÂ 
(
ÂÂ 
spName
ÂÂ 
==
ÂÂ 
null
ÂÂ 
||
ÂÂ !
spName
ÂÂ" (
.
ÂÂ( )
Length
ÂÂ) /
==
ÂÂ0 2
$num
ÂÂ3 4
)
ÂÂ4 5
throw
ÂÂ6 ;
new
ÂÂ< ?#
ArgumentNullException
ÂÂ@ U
(
ÂÂU V
$str
ÂÂV ^
)
ÂÂ^ _
;
ÂÂ_ `
string
ÄÄ 
hashKey
ÄÄ 
=
ÄÄ 

connection
ÄÄ '
.
ÄÄ' (
ConnectionString
ÄÄ( 8
+
ÄÄ9 :
$str
ÄÄ; >
+
ÄÄ? @
spName
ÄÄA G
+
ÄÄH I
(
ÄÄJ K)
includeReturnValueParameter
ÄÄK f
?
ÄÄg h
$strÄÄi ‰
:ÄÄŠ ‹
$strÄÄŒ 
)ÄÄ 
;ÄÄ 
SqlParameter
ÆÆ 
[
ÆÆ 
]
ÆÆ 
cachedParameters
ÆÆ +
;
ÆÆ+ ,
cachedParameters
ÈÈ 
=
ÈÈ 

paramCache
ÈÈ )
[
ÈÈ) *
hashKey
ÈÈ* 1
]
ÈÈ1 2
as
ÈÈ3 5
SqlParameter
ÈÈ6 B
[
ÈÈB C
]
ÈÈC D
;
ÈÈD E
if
ÉÉ 
(
ÉÉ 
cachedParameters
ÉÉ  
==
ÉÉ! #
null
ÉÉ$ (
)
ÉÉ( )
{
ÊÊ 
SqlParameter
ËË 
[
ËË 
]
ËË 
spParameters
ËË +
=
ËË, -$
DiscoverSpParameterSet
ËË. D
(
ËËD E

connection
ËËE O
,
ËËO P
spName
ËËQ W
,
ËËW X)
includeReturnValueParameter
ËËY t
)
ËËt u
;
ËËu v

paramCache
ÌÌ 
[
ÌÌ 
hashKey
ÌÌ "
]
ÌÌ" #
=
ÌÌ$ %
spParameters
ÌÌ& 2
;
ÌÌ2 3
cachedParameters
ÍÍ  
=
ÍÍ! "
spParameters
ÍÍ# /
;
ÍÍ/ 0
}
ÎÎ 
return
ĞĞ 
CloneParameters
ĞĞ "
(
ĞĞ" #
cachedParameters
ĞĞ# 3
)
ĞĞ3 4
;
ĞĞ4 5
}
ÑÑ 	
}
ÕÕ 
}ÖÖ 